# SASI Neural Agent System - Troubleshooting Guide

**Version:** 2.0.0-phase2b  
**Status:** Production Ready  
**Generated:** 2025-07-18  
**Generated by:** DocsEngineer Agent

## üìã Table of Contents

1. [Quick Diagnostics](#quick-diagnostics)
2. [Common Issues](#common-issues)
3. [Performance Problems](#performance-problems)
4. [Agent Issues](#agent-issues)
5. [Database Problems](#database-problems)
6. [Network and Connectivity](#network-and-connectivity)
7. [Browser and UI Issues](#browser-and-ui-issues)
8. [Security and Authentication](#security-and-authentication)
9. [Deployment Issues](#deployment-issues)
10. [Emergency Procedures](#emergency-procedures)
11. [Diagnostic Tools](#diagnostic-tools)
12. [Getting Help](#getting-help)

## üöÄ Quick Diagnostics

### System Health Check (30 seconds)

Run these commands to quickly assess system health:

```bash
# 1. Application health
curl -f http://localhost:3000/health
# Expected: {"status":"healthy","uptime":3600,"version":"2.0.0-phase2b"}

# 2. Performance metrics
curl http://localhost:3000/api/metrics | jq '.systemMetrics.systemHealth'
# Expected: > 0.95 (95%+ health score)

# 3. Agent count
curl http://localhost:3000/api/agents | jq '.data.pagination.total'
# Expected: Current agent count

# 4. Database connectivity
sqlite3 /path/to/neural.db "SELECT COUNT(*) FROM neural_agents;"
# Expected: Number of agents in database

# 5. Memory usage
free -m | grep Mem
# Expected: Available memory > 1GB for production
```

### Quick Status Dashboard

```bash
#!/bin/bash
# quick-status.sh - Run comprehensive health check

echo "=== SASI Neural Agent System Status ==="
echo "Timestamp: $(date)"
echo

# Application status
echo "üîç Application Health:"
health=$(curl -s http://localhost:3000/health 2>/dev/null)
if [ $? -eq 0 ]; then
    echo "‚úÖ Application: Running"
    echo "   $(echo $health | jq -r '.status // "unknown"')"
else
    echo "‚ùå Application: Not responding"
fi
echo

# System resources
echo "üíæ System Resources:"
memory_usage=$(free | grep Mem | awk '{printf "%.1f", $3/$2 * 100.0}')
disk_usage=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
cpu_load=$(uptime | awk -F'load average:' '{ print $2 }' | awk '{ print $1 }' | sed 's/,//')

echo "   Memory: ${memory_usage}% used"
echo "   Disk: ${disk_usage}% used"
echo "   Load: ${cpu_load}"
echo

# Agent status
echo "ü§ñ Agent Status:"
agent_count=$(curl -s http://localhost:3000/api/agents 2>/dev/null | jq -r '.data.pagination.total // 0')
echo "   Total Agents: ${agent_count}"
echo

# Performance metrics
echo "‚ö° Performance:"
metrics=$(curl -s http://localhost:3000/api/metrics 2>/dev/null)
if [ $? -eq 0 ]; then
    health_score=$(echo $metrics | jq -r '.systemMetrics.systemHealth // 0')
    avg_inference=$(echo $metrics | jq -r '.systemMetrics.averageInferenceTime // 0')
    echo "   Health Score: $(echo $health_score | awk '{printf "%.1f%%", $1*100}')"
    echo "   Avg Inference: ${avg_inference}ms"
else
    echo "   Metrics: Not available"
fi
echo

echo "=== End Status Check ==="
```

## üõ†Ô∏è Common Issues

### Issue: Application Won't Start

#### Symptoms
- Application fails to start
- Port binding errors
- Process exits immediately
- Health check fails

#### Diagnostic Steps
```bash
# 1. Check if port is in use
netstat -tlnp | grep :3000
lsof -i :3000

# 2. Check environment variables
env | grep -E "NODE_ENV|DATABASE_PATH|NEURAL_"

# 3. Check file permissions
ls -la /path/to/sasi/
ls -la /path/to/sasi/data/

# 4. Check disk space
df -h

# 5. Check logs
tail -50 /path/to/sasi/logs/sasi-error.log
journalctl -u sasi-service -n 50
```

#### Common Causes and Solutions

**Port Already in Use:**
```bash
# Find process using port
sudo lsof -i :3000

# Kill process (if safe)
sudo kill -9 <PID>

# Or change port
export PORT=3001
```

**Permission Issues:**
```bash
# Fix file permissions
sudo chown -R sasi:sasi /opt/sasi/
chmod 755 /opt/sasi/
chmod 700 /opt/sasi/data/
```

**Missing Environment Variables:**
```bash
# Set required variables
export NODE_ENV=production
export DATABASE_PATH=/opt/sasi/data/neural.db
export NEURAL_MAX_AGENTS=25
```

**Insufficient Disk Space:**
```bash
# Clean up logs
sudo logrotate -f /etc/logrotate.d/sasi

# Clean up old backups
find /opt/sasi/backups -name "*.db.gz" -mtime +30 -delete

# Clear npm cache
npm cache clean --force
```

### Issue: Slow Performance

#### Symptoms
- Response times > 100ms
- High CPU/memory usage
- UI feels sluggish
- Agent operations timeout

#### Diagnostic Steps
```bash
# 1. Check system resources
htop
iotop -a

# 2. Check application metrics
curl http://localhost:3000/api/metrics | jq '.systemMetrics'

# 3. Check agent performance
curl http://localhost:3000/api/agents | jq '.data.agents[] | {id: .id, performance: .performance}'

# 4. Check database performance
time sqlite3 /path/to/neural.db "SELECT COUNT(*) FROM neural_agents;"

# 5. Check network latency
ping -c 5 localhost
```

#### Performance Optimization Solutions

**High Memory Usage:**
```bash
# Check memory per process
ps aux --sort=-%mem | head -10

# Restart application to clear memory
pm2 restart sasi-neural

# Reduce agent count temporarily
curl -X DELETE http://localhost:3000/api/agents/idle

# Enable memory pooling
export NEURAL_MEMORY_POOLING=true
```

**High CPU Usage:**
```bash
# Check CPU usage by process
top -p $(pgrep -f sasi)

# Enable SIMD acceleration
export WASM_SIMD_ENABLED=true

# Reduce concurrent operations
export NEURAL_MAX_CONCURRENT_OPERATIONS=10
```

**Database Performance:**
```sql
-- Optimize SQLite
PRAGMA journal_mode = WAL;
PRAGMA synchronous = NORMAL;
PRAGMA cache_size = 10000;
PRAGMA optimize;
```

### Issue: Connection Timeouts

#### Symptoms
- WebSocket disconnections
- API timeouts
- "Connection refused" errors
- Intermittent connectivity

#### Diagnostic Steps
```bash
# 1. Check network connectivity
ping -c 5 google.com
wget -qO- http://localhost:3000/health

# 2. Check firewall
sudo ufw status
iptables -L

# 3. Check nginx (if used)
sudo nginx -t
sudo systemctl status nginx

# 4. Check load balancer
curl -I http://localhost:3000/

# 5. Check DNS resolution
nslookup your-domain.com
```

#### Solutions

**Firewall Issues:**
```bash
# Allow application port
sudo ufw allow 3000/tcp

# Allow nginx ports
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# Check rules
sudo ufw status numbered
```

**Nginx Configuration:**
```nginx
# Increase timeouts
proxy_connect_timeout 60s;
proxy_send_timeout 60s;
proxy_read_timeout 60s;

# WebSocket support
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection "upgrade";
```

**Application Timeouts:**
```javascript
// Increase timeout settings
{
  "server": {
    "timeout": 60000,
    "keepAliveTimeout": 65000
  },
  "database": {
    "connectionTimeout": 10000,
    "busyTimeout": 15000
  }
}
```

## ‚ö° Performance Problems

### High Response Times

#### Symptoms
- API responses > 100ms
- Neural inference > 100ms
- UI operations feel slow
- Performance alerts triggered

#### Diagnostic Commands
```bash
# 1. Real-time performance monitoring
curl -s http://localhost:3000/api/metrics | jq '{
  inference_time: .systemMetrics.averageInferenceTime,
  memory_usage: .systemMetrics.totalMemoryUsage,
  cpu_usage: .systemMetrics.cpuUsage,
  agent_count: .systemMetrics.totalAgents
}'

# 2. Agent-specific performance
curl -s http://localhost:3000/api/agents | jq '.data.agents[] | {
  id: .id,
  type: .type,
  inference_time: .performance.inferenceTime,
  memory: .performance.memoryUsage,
  efficiency: .performance.efficiency
}'

# 3. Database query performance
time sqlite3 /path/to/neural.db "
.timer on
SELECT COUNT(*) FROM neural_agents;
SELECT COUNT(*) FROM neural_events WHERE timestamp > datetime('now', '-1 hour');
"
```

#### Optimization Strategies

**1. Agent Optimization:**
```bash
# Remove underperforming agents
curl -X DELETE http://localhost:3000/api/agents/agent-id

# Restart slow agents
curl -X POST http://localhost:3000/api/agents/agent-id/commands \
  -H "Content-Type: application/json" \
  -d '{"command": "restart"}'

# Optimize agent configuration
curl -X PUT http://localhost:3000/api/agents/agent-id \
  -H "Content-Type: application/json" \
  -d '{
    "neuralConfig": {
      "learningRate": 0.0005,
      "memoryLimit": 30,
      "enableCaching": true
    }
  }'
```

**2. System Optimization:**
```bash
# Enable all performance features
export WASM_SIMD_ENABLED=true
export NEURAL_MEMORY_POOLING=true
export CACHE_ENABLED=true
export BATCH_PROCESSING_ENABLED=true

# Optimize garbage collection
export NODE_OPTIONS="--gc-interval=100 --max-old-space-size=4096"

# Restart with optimizations
pm2 restart sasi-neural
```

**3. Database Optimization:**
```sql
-- Database maintenance
PRAGMA optimize;
VACUUM;

-- Index optimization
CREATE INDEX IF NOT EXISTS idx_agents_status ON neural_agents(status);
CREATE INDEX IF NOT EXISTS idx_events_timestamp ON neural_events(timestamp);

-- Connection optimization
PRAGMA journal_mode = WAL;
PRAGMA synchronous = NORMAL;
PRAGMA cache_size = 20000;
PRAGMA mmap_size = 268435456;
```

### Memory Leaks

#### Symptoms
- Memory usage continuously increasing
- Application becomes unresponsive
- Out of memory errors
- System swap usage increasing

#### Detection and Analysis
```bash
# 1. Monitor memory trends
watch -n 5 'free -m && ps aux | grep node | grep -v grep'

# 2. Memory usage by process
ps -o pid,ppid,cmd,%mem,%cpu --sort=-%mem | head -20

# 3. Heap analysis (if Node.js debugging enabled)
curl http://localhost:9229/json/list
# Use Chrome DevTools for heap analysis

# 4. Check for memory leaks in logs
grep -i "memory\|heap\|allocation" /path/to/sasi/logs/sasi.log
```

#### Memory Leak Solutions

**1. Regular Restarts:**
```bash
# Schedule regular restarts (crontab)
0 2 * * * pm2 restart sasi-neural

# Or use PM2 memory limits
pm2 start app.js --max-memory-restart 1G
```

**2. Memory Monitoring:**
```javascript
// Add to application code
setInterval(() => {
  const usage = process.memoryUsage();
  console.log('Memory usage:', {
    rss: Math.round(usage.rss / 1024 / 1024) + ' MB',
    heapTotal: Math.round(usage.heapTotal / 1024 / 1024) + ' MB',
    heapUsed: Math.round(usage.heapUsed / 1024 / 1024) + ' MB'
  });
}, 30000);
```

**3. Agent Memory Management:**
```bash
# Enable aggressive memory cleanup
export NEURAL_AGGRESSIVE_GC=true
export NEURAL_MEMORY_CLEANUP_INTERVAL=60000

# Limit agent memory individually
curl -X PUT http://localhost:3000/api/agents/bulk-update \
  -H "Content-Type: application/json" \
  -d '{
    "filter": {"memoryUsage": {"$gt": 40}},
    "update": {"neuralConfig": {"memoryLimit": 30}}
  }'
```

## ü§ñ Agent Issues

### Agent Spawn Failures

#### Symptoms
- "Agent spawn failed" errors
- Agents not appearing in UI
- Spawn time > 75ms consistently
- Resource limit errors

#### Diagnostic Steps
```bash
# 1. Check current agent count
curl -s http://localhost:3000/api/agents | jq '.data.pagination.total'

# 2. Check system resources
free -m
df -h

# 3. Check agent limits
curl -s http://localhost:3000/api/metrics | jq '.systemMetrics.totalAgents, .limits.maxAgents'

# 4. Test agent spawn
time curl -X POST http://localhost:3000/api/agents \
  -H "Content-Type: application/json" \
  -d '{"type": "researcher", "name": "test-agent"}'

# 5. Check error logs
grep "spawn\|agent.*fail" /path/to/sasi/logs/sasi.log | tail -10
```

#### Solutions

**Resource Limits:**
```bash
# Increase agent limit
export NEURAL_MAX_AGENTS=50

# Check and clean up idle agents
curl -X GET http://localhost:3000/api/agents?status=idle
curl -X DELETE http://localhost:3000/api/agents/bulk-remove \
  -H "Content-Type: application/json" \
  -d '{"filter": {"status": "idle", "uptime": {"$lt": 300}}}'

# Free up memory
pm2 restart sasi-neural
```

**Configuration Issues:**
```bash
# Test with minimal configuration
curl -X POST http://localhost:3000/api/agents \
  -H "Content-Type: application/json" \
  -d '{
    "type": "researcher",
    "name": "minimal-test",
    "neuralConfig": {
      "memoryLimit": 20,
      "inferenceTimeout": 200
    }
  }'

# Check configuration file
cat /path/to/config/production.json | jq '.neuralConfig'
```

### Agent Performance Issues

#### Symptoms
- Efficiency < 90%
- Inference time > 100ms
- High memory usage per agent
- Frequent agent errors

#### Performance Analysis
```bash
# 1. Agent performance breakdown
curl -s http://localhost:3000/api/agents | jq '
.data.agents[] | select(.performance.efficiency < 0.9) | {
  id: .id,
  type: .type,
  efficiency: .performance.efficiency,
  inference_time: .performance.inferenceTime,
  memory: .performance.memoryUsage,
  errors: .performance.errorRate
}'

# 2. Compare by agent type
curl -s http://localhost:3000/api/agents | jq '
group_by(.type) | map({
  type: .[0].type,
  count: length,
  avg_efficiency: (map(.performance.efficiency) | add / length),
  avg_inference: (map(.performance.inferenceTime) | add / length)
})'

# 3. Historical performance
curl -s "http://localhost:3000/api/performance/metrics?timeRange=1h&agentId=agent-001"
```

#### Optimization Solutions

**1. Agent-Specific Optimization:**
```bash
# Restart underperforming agents
for agent in $(curl -s http://localhost:3000/api/agents | jq -r '.data.agents[] | select(.performance.efficiency < 0.8) | .id'); do
  curl -X POST http://localhost:3000/api/agents/$agent/commands \
    -H "Content-Type: application/json" \
    -d '{"command": "restart"}'
done

# Optimize neural configuration
curl -X PUT http://localhost:3000/api/agents/agent-001 \
  -H "Content-Type: application/json" \
  -d '{
    "neuralConfig": {
      "learningRate": 0.0005,
      "memoryLimit": 35,
      "enableSIMD": true,
      "enableCaching": true,
      "batchSize": 16
    }
  }'
```

**2. System-Wide Optimization:**
```bash
# Enable performance features
export WASM_SIMD_ENABLED=true
export NEURAL_BATCH_PROCESSING=true
export NEURAL_MEMORY_POOLING=true

# Restart with optimizations
pm2 restart sasi-neural --update-env
```

### Agent Communication Issues

#### Symptoms
- Agents not coordinating
- Cross-learning failures
- Task distribution problems
- Coordination timeouts

#### Diagnostic Commands
```bash
# 1. Check coordination status
curl -s http://localhost:3000/api/agents/coordination-status

# 2. Test agent communication
curl -X POST http://localhost:3000/api/agents/test-communication \
  -H "Content-Type: application/json" \
  -d '{"sourceAgent": "agent-001", "targetAgent": "agent-002"}'

# 3. Check coordination logs
grep -i "coordination\|cross.*learn\|knowledge.*transfer" /path/to/sasi/logs/sasi.log | tail -20

# 4. Monitor coordination metrics
curl -s http://localhost:3000/api/metrics | jq '.coordinationMetrics'
```

#### Solutions

**1. Restart Coordination System:**
```bash
# Reset coordination cache
curl -X POST http://localhost:3000/api/system/coordination/reset

# Restart coordination service
curl -X POST http://localhost:3000/api/system/coordination/restart
```

**2. Manual Coordination:**
```bash
# Force knowledge transfer
curl -X POST http://localhost:3000/api/agents/knowledge-transfer \
  -H "Content-Type: application/json" \
  -d '{
    "sourceAgent": "agent-001",
    "targetAgent": "agent-002",
    "transferType": "patterns"
  }'

# Redistribute tasks
curl -X POST http://localhost:3000/api/agents/redistribute-tasks
```

## üóÑÔ∏è Database Problems

### Database Corruption

#### Symptoms
- SQLite "database disk image is malformed"
- Data inconsistencies
- Query failures
- Application crashes on database operations

#### Detection and Repair
```bash
# 1. Check database integrity
sqlite3 /path/to/neural.db "PRAGMA integrity_check;"

# 2. Quick check
sqlite3 /path/to/neural.db "PRAGMA quick_check;"

# 3. Check for corruption patterns
sqlite3 /path/to/neural.db ".schema" 2>&1 | grep -i error

# 4. Backup before repair
cp /path/to/neural.db /path/to/neural.db.backup

# 5. Attempt repair
sqlite3 /path/to/neural.db "
PRAGMA writable_schema = ON;
UPDATE sqlite_master SET sql = sql WHERE type = 'table';
PRAGMA writable_schema = OFF;
PRAGMA integrity_check;
"
```

#### Recovery Strategies

**1. Automatic Recovery:**
```bash
# Export data to SQL
sqlite3 /path/to/neural.db ".dump" > recovery.sql

# Create new database
rm /path/to/neural.db
sqlite3 /path/to/neural.db < recovery.sql

# Verify recovery
sqlite3 /path/to/neural.db "PRAGMA integrity_check;"
```

**2. Restore from Backup:**
```bash
# Stop application
pm2 stop sasi-neural

# Restore latest backup
gunzip -c /path/to/backups/neural_backup_latest.db.gz > /path/to/neural.db

# Verify restore
sqlite3 /path/to/neural.db "SELECT COUNT(*) FROM neural_agents;"

# Start application
pm2 start sasi-neural
```

### Database Performance Issues

#### Symptoms
- Slow query responses
- Database locks
- High disk I/O
- Query timeouts

#### Performance Analysis
```bash
# 1. Query performance testing
time sqlite3 /path/to/neural.db "
.timer on
SELECT COUNT(*) FROM neural_agents;
SELECT COUNT(*) FROM neural_events WHERE timestamp > datetime('now', '-1 hour');
SELECT type, COUNT(*) FROM neural_agents GROUP BY type;
"

# 2. Database size analysis
ls -lh /path/to/neural.db*
sqlite3 /path/to/neural.db "
SELECT name, COUNT(*) as records FROM (
  SELECT 'neural_agents' as name FROM neural_agents
  UNION ALL
  SELECT 'neural_events' as name FROM neural_events
) GROUP BY name;
"

# 3. Lock analysis
lsof /path/to/neural.db
```

#### Performance Optimization

**1. Database Maintenance:**
```sql
-- Regular maintenance script
PRAGMA optimize;
VACUUM;
REINDEX;

-- Performance settings
PRAGMA journal_mode = WAL;
PRAGMA synchronous = NORMAL;
PRAGMA cache_size = 20000;
PRAGMA temp_store = MEMORY;
PRAGMA mmap_size = 268435456;
```

**2. Index Optimization:**
```sql
-- Create performance indexes
CREATE INDEX IF NOT EXISTS idx_agents_type_status ON neural_agents(type, status);
CREATE INDEX IF NOT EXISTS idx_events_agent_timestamp ON neural_events(agent_id, timestamp);
CREATE INDEX IF NOT EXISTS idx_events_timestamp_desc ON neural_events(timestamp DESC);

-- Analyze query plans
EXPLAIN QUERY PLAN SELECT * FROM neural_agents WHERE status = 'active';
```

### Database Connection Issues

#### Symptoms
- "Database locked" errors
- Connection timeouts
- "Database is busy" messages
- Intermittent database failures

#### Diagnostic Steps
```bash
# 1. Check database locks
lsof /path/to/neural.db
fuser /path/to/neural.db

# 2. Check file permissions
ls -la /path/to/neural.db*
ls -ld /path/to/database/directory/

# 3. Test database connectivity
sqlite3 /path/to/neural.db "SELECT 1;"

# 4. Check for WAL files
ls -la /path/to/neural.db-*
```

#### Solutions

**1. Clear Database Locks:**
```bash
# Stop application
pm2 stop sasi-neural

# Clear any remaining locks
fuser -k /path/to/neural.db

# Restart application
pm2 start sasi-neural
```

**2. Database Configuration:**
```sql
-- Configure for concurrent access
PRAGMA journal_mode = WAL;
PRAGMA wal_autocheckpoint = 1000;
PRAGMA busy_timeout = 30000;
```

**3. File System Fixes:**
```bash
# Fix permissions
chown sasi:sasi /path/to/neural.db*
chmod 660 /path/to/neural.db*

# Ensure directory permissions
chown sasi:sasi /path/to/database/directory/
chmod 750 /path/to/database/directory/
```

## üåê Network and Connectivity

### WebSocket Connection Issues

#### Symptoms
- Real-time updates not working
- "WebSocket disconnected" messages
- Events not received in UI
- Connection drops frequently

#### Diagnostic Steps
```bash
# 1. Test WebSocket endpoint
curl -i -N -H "Connection: Upgrade" \
     -H "Upgrade: websocket" \
     -H "Sec-WebSocket-Key: test" \
     -H "Sec-WebSocket-Version: 13" \
     http://localhost:3000/ws

# 2. Check nginx WebSocket config (if using nginx)
sudo nginx -T | grep -A 20 -B 5 "websocket\|upgrade"

# 3. Test from browser console
# In browser developer console:
# const ws = new WebSocket('ws://localhost:3000/ws');
# ws.onopen = () => console.log('Connected');
# ws.onerror = (error) => console.log('Error:', error);

# 4. Check firewall rules
sudo netstat -tlnp | grep :3000
sudo ufw status | grep 3000
```

#### Solutions

**1. Nginx Configuration Fix:**
```nginx
# Add to nginx server block
location /ws {
    proxy_pass http://backend;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_read_timeout 86400;
    proxy_send_timeout 86400;
}
```

**2. Application Configuration:**
```javascript
// WebSocket server configuration
{
  "websocket": {
    "pingInterval": 25000,
    "pingTimeout": 60000,
    "upgradeTimeout": 10000,
    "maxHttpBufferSize": 1048576
  }
}
```

### API Rate Limiting Issues

#### Symptoms
- "Rate limit exceeded" errors (429)
- API calls being rejected
- Slow API responses
- Authentication failures

#### Check Rate Limits
```bash
# 1. Check current rate limit status
curl -I http://localhost:3000/api/agents

# Look for headers:
# X-RateLimit-Limit: 1000
# X-RateLimit-Remaining: 999
# X-RateLimit-Reset: 1642522800

# 2. Test rate limit threshold
for i in {1..10}; do
  curl -w "%{http_code} " -s -o /dev/null http://localhost:3000/api/agents
done

# 3. Check rate limit configuration
curl -s http://localhost:3000/api/system/rate-limits
```

#### Solutions

**1. Adjust Rate Limits:**
```javascript
// In configuration
{
  "rateLimit": {
    "enabled": true,
    "requests": 2000,        // Increase from 1000
    "window": "15m",
    "skipSuccessfulRequests": true  // Don't count successful requests
  }
}
```

**2. Implement Backoff Strategy:**
```javascript
// Client-side retry with exponential backoff
async function apiCallWithRetry(url, options = {}, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      const response = await fetch(url, options);
      
      if (response.status === 429) {
        const retryAfter = response.headers.get('Retry-After') || Math.pow(2, i);
        await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));
        continue;
      }
      
      return response;
    } catch (error) {
      if (i === maxRetries - 1) throw error;
      await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
    }
  }
}
```

### SSL/TLS Certificate Issues

#### Symptoms
- "Certificate expired" warnings
- "Untrusted certificate" errors
- SSL handshake failures
- Mixed content warnings

#### Certificate Diagnostics
```bash
# 1. Check certificate expiration
openssl x509 -in /etc/ssl/certs/sasi.crt -noout -dates

# 2. Test SSL configuration
openssl s_client -connect sasi.your-domain.com:443 -servername sasi.your-domain.com

# 3. Check certificate chain
curl -vI https://sasi.your-domain.com

# 4. Validate certificate
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/sasi.crt
```

#### Certificate Solutions

**1. Renew Let's Encrypt Certificate:**
```bash
# Manual renewal
sudo certbot renew --nginx

# Test renewal
sudo certbot renew --dry-run

# Force renewal
sudo certbot renew --force-renewal
```

**2. Update Self-Signed Certificate:**
```bash
# Generate new certificate
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/sasi.key \
  -out /etc/ssl/certs/sasi.crt \
  -subj "/C=US/ST=State/L=City/O=Organization/CN=sasi.your-domain.com"

# Restart nginx
sudo systemctl restart nginx
```

## üñ•Ô∏è Browser and UI Issues

### 3D Visualization Problems

#### Symptoms
- Black screen instead of 3D view
- WebGL errors in console
- Poor 3D performance
- Visualization not updating

#### Browser Compatibility Check
```javascript
// Run in browser console
console.log('WebGL Support:', {
  webgl: !!window.WebGLRenderingContext,
  webgl2: !!window.WebGL2RenderingContext,
  renderer: getWebGLRenderer(),
  vendor: getWebGLVendor()
});

function getWebGLRenderer() {
  const canvas = document.createElement('canvas');
  const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
  return gl ? gl.getParameter(gl.RENDERER) : 'Not available';
}

function getWebGLVendor() {
  const canvas = document.createElement('canvas');
  const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
  return gl ? gl.getParameter(gl.VENDOR) : 'Not available';
}
```

#### Solutions

**1. Browser Updates:**
```bash
# Update to latest browser
# Chrome: chrome://settings/help
# Firefox: about:support -> Refresh Firefox
# Safari: System Preferences -> Software Update

# Enable hardware acceleration
# Chrome: chrome://settings/ -> Advanced -> System -> "Use hardware acceleration when available"
# Firefox: about:preferences -> General -> Performance -> "Use hardware acceleration when available"
```

**2. WebGL Troubleshooting:**
```javascript
// Test WebGL functionality
const canvas = document.createElement('canvas');
const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');

if (!gl) {
  console.error('WebGL not supported');
  // Fallback to 2D view
  window.location.hash = '#/agents'; // Switch to agents view
} else {
  console.log('WebGL supported:', gl.getParameter(gl.VERSION));
}
```

**3. Performance Optimization:**
```javascript
// Reduce 3D complexity
{
  "visualization": {
    "maxParticles": 100,     // Reduce from 500
    "enableShadows": false,  // Disable shadows
    "antialias": false,      // Disable antialiasing
    "maxAgentsRendered": 25  // Limit rendered agents
  }
}
```

### UI Responsiveness Issues

#### Symptoms
- Slow button responses
- UI freezing
- Layout problems on mobile
- JavaScript errors

#### Performance Diagnostics
```javascript
// Run in browser console
console.log('Performance Info:', {
  memory: performance.memory ? {
    used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + 'MB',
    total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024) + 'MB',
    limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024) + 'MB'
  } : 'Not available',
  timing: performance.timing,
  navigation: performance.navigation
});

// Check for memory leaks
setInterval(() => {
  if (performance.memory) {
    console.log('Memory usage:', 
      Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + 'MB');
  }
}, 10000);
```

#### UI Optimization

**1. Clear Browser Data:**
```bash
# Chrome: chrome://settings/clearBrowserData
# Firefox: about:preferences#privacy -> Clear Data
# Safari: Develop menu -> Empty Caches

# Or programmatically clear cache
# In browser console:
# caches.keys().then(names => names.forEach(name => caches.delete(name)));
```

**2. Disable Unnecessary Features:**
```javascript
// Reduce UI updates
{
  "ui": {
    "updateInterval": 5000,     // Increase from 1000ms
    "enableAnimations": false,  // Disable animations
    "enableParticles": false,   // Disable particle effects
    "maxVisibleAgents": 20      // Limit visible agents
  }
}
```

### JavaScript Errors

#### Common Error Types

**1. "Cannot read property of undefined":**
```javascript
// Check in browser console
console.log('Common undefined errors:');
console.log('Window objects:', {
  React: typeof React,
  THREE: typeof THREE,
  WebSocket: typeof WebSocket
});

// Safe property access
const safeGet = (obj, path) => {
  return path.split('.').reduce((current, key) => 
    current && current[key] !== undefined ? current[key] : undefined, obj);
};
```

**2. Network/CORS Errors:**
```javascript
// Test API connectivity
fetch('/api/health')
  .then(response => response.json())
  .then(data => console.log('API health:', data))
  .catch(error => console.error('API error:', error));

// Check CORS headers
fetch('/api/agents', {mode: 'cors'})
  .then(response => {
    console.log('CORS headers:', {
      'Access-Control-Allow-Origin': response.headers.get('Access-Control-Allow-Origin'),
      'Access-Control-Allow-Methods': response.headers.get('Access-Control-Allow-Methods')
    });
  });
```

## üîê Security and Authentication

### Authentication Failures

#### Symptoms
- "Unauthorized" (401) errors
- Token expiration messages
- Login loops
- Access denied errors

#### Token Diagnostics
```bash
# 1. Test authentication endpoint
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"password"}'

# 2. Validate JWT token
# Use jwt.io to decode token or:
node -e "
const jwt = require('jsonwebtoken');
const token = 'your-jwt-token-here';
try {
  const decoded = jwt.decode(token);
  console.log('Token payload:', decoded);
  console.log('Expires:', new Date(decoded.exp * 1000));
} catch (e) {
  console.error('Invalid token:', e.message);
}
"

# 3. Check token in requests
curl -H "Authorization: Bearer your-jwt-token" \
     http://localhost:3000/api/agents
```

#### Authentication Solutions

**1. Token Refresh:**
```javascript
// Implement automatic token refresh
async function refreshToken() {
  try {
    const response = await fetch('/api/auth/refresh', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${localStorage.getItem('refreshToken')}`
      }
    });
    
    if (response.ok) {
      const data = await response.json();
      localStorage.setItem('authToken', data.token);
      localStorage.setItem('refreshToken', data.refreshToken);
      return data.token;
    }
  } catch (error) {
    console.error('Token refresh failed:', error);
    // Redirect to login
    window.location.href = '/login';
  }
}

// Auto-refresh before expiration
setInterval(refreshToken, 20 * 60 * 1000); // 20 minutes
```

**2. Session Recovery:**
```javascript
// Check for valid session on page load
document.addEventListener('DOMContentLoaded', async () => {
  const token = localStorage.getItem('authToken');
  
  if (token) {
    try {
      const response = await fetch('/api/auth/verify', {
        headers: {'Authorization': `Bearer ${token}`}
      });
      
      if (!response.ok) {
        localStorage.removeItem('authToken');
        localStorage.removeItem('refreshToken');
        window.location.href = '/login';
      }
    } catch (error) {
      console.error('Session verification failed:', error);
    }
  }
});
```

### Permission Errors

#### Symptoms
- "Forbidden" (403) errors
- Access denied for specific operations
- Role-based access failures
- Resource permission errors

#### Permission Diagnostics
```bash
# 1. Check user permissions
curl -H "Authorization: Bearer your-token" \
     http://localhost:3000/api/auth/permissions

# 2. Test specific operation
curl -X POST -H "Authorization: Bearer your-token" \
     -H "Content-Type: application/json" \
     -d '{"type":"researcher"}' \
     http://localhost:3000/api/agents

# 3. Check role assignments
curl -H "Authorization: Bearer your-token" \
     http://localhost:3000/api/auth/user-info
```

#### Permission Solutions

**1. Role Assignment:**
```javascript
// Update user role (admin only)
fetch('/api/auth/users/user-id/role', {
  method: 'PUT',
  headers: {
    'Authorization': `Bearer ${adminToken}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    role: 'operator',
    permissions: ['agents:read', 'agents:write', 'monitoring:read']
  })
});
```

**2. Permission Checking:**
```javascript
// Check permissions before operations
async function checkPermission(permission) {
  try {
    const response = await fetch('/api/auth/permissions');
    const permissions = await response.json();
    return permissions.includes(permission) || permissions.includes('*');
  } catch (error) {
    return false;
  }
}

// Use before sensitive operations
if (await checkPermission('agents:write')) {
  // Proceed with agent creation
} else {
  // Show permission error
}
```

## üöÄ Deployment Issues

### Container Startup Problems

#### Symptoms
- Docker containers fail to start
- Container exits immediately
- Health checks failing
- Port binding errors

#### Container Diagnostics
```bash
# 1. Check container status
docker ps -a
docker logs container-name

# 2. Inspect container configuration
docker inspect container-name

# 3. Test container manually
docker run -it --rm sasi-neural:latest /bin/sh

# 4. Check resource usage
docker stats

# 5. Test port binding
docker run -p 3000:3000 sasi-neural:latest
```

#### Container Solutions

**1. Fix Resource Issues:**
```bash
# Increase memory limits
docker run --memory=2g --memory-swap=4g sasi-neural:latest

# Check disk space
df -h
docker system prune -a

# Fix permission issues
docker run --user 1001:1001 sasi-neural:latest
```

**2. Configuration Problems:**
```dockerfile
# Add health check to Dockerfile
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1

# Fix environment variables
ENV NODE_ENV=production
ENV DATABASE_PATH=/app/data/neural.db
```

### Kubernetes Deployment Issues

#### Symptoms
- Pods in CrashLoopBackOff
- Services not accessible
- Persistent volume issues
- Resource quota exceeded

#### K8s Diagnostics
```bash
# 1. Check pod status
kubectl get pods -n sasi-production
kubectl describe pod pod-name -n sasi-production

# 2. Check logs
kubectl logs pod-name -n sasi-production
kubectl logs -f deployment/sasi-app -n sasi-production

# 3. Check services
kubectl get svc -n sasi-production
kubectl describe svc sasi-app-service -n sasi-production

# 4. Check ingress
kubectl get ingress -n sasi-production
kubectl describe ingress sasi-ingress -n sasi-production

# 5. Check resources
kubectl top pods -n sasi-production
kubectl describe nodes
```

#### K8s Solutions

**1. Pod Issues:**
```bash
# Fix resource limits
kubectl patch deployment sasi-app -n sasi-production -p='
{
  "spec": {
    "template": {
      "spec": {
        "containers": [{
          "name": "sasi-app",
          "resources": {
            "requests": {"memory": "1Gi", "cpu": "500m"},
            "limits": {"memory": "2Gi", "cpu": "1000m"}
          }
        }]
      }
    }
  }
}'

# Restart deployment
kubectl rollout restart deployment/sasi-app -n sasi-production
```

**2. Persistent Volume Issues:**
```bash
# Check PV status
kubectl get pv
kubectl get pvc -n sasi-production

# Fix volume permissions
kubectl exec -it pod-name -n sasi-production -- chown -R 1001:1001 /app/data
```

## üö® Emergency Procedures

### System Recovery

#### Complete System Failure
```bash
#!/bin/bash
# emergency-recovery.sh

echo "=== SASI Emergency Recovery ==="
echo "Timestamp: $(date)"

# 1. Stop all services
echo "Stopping services..."
pm2 stop all 2>/dev/null || systemctl stop sasi-service
sudo systemctl stop nginx

# 2. Backup current state
echo "Creating emergency backup..."
mkdir -p /tmp/sasi-emergency-$(date +%Y%m%d_%H%M%S)
cp -r /opt/sasi/data /tmp/sasi-emergency-$(date +%Y%m%d_%H%M%S)/
cp -r /opt/sasi/logs /tmp/sasi-emergency-$(date +%Y%m%d_%H%M%S)/

# 3. Clear problematic files
echo "Cleaning temporary files..."
rm -f /opt/sasi/data/*.lock
rm -f /opt/sasi/data/*-wal
rm -f /opt/sasi/data/*-shm

# 4. Restore from latest backup
echo "Restoring from backup..."
if [ -f /opt/sasi/backups/neural_backup_latest.db.gz ]; then
    gunzip -c /opt/sasi/backups/neural_backup_latest.db.gz > /opt/sasi/data/neural.db
    echo "Database restored from backup"
else
    echo "WARNING: No backup found, creating new database"
    touch /opt/sasi/data/neural.db
fi

# 5. Fix permissions
echo "Fixing permissions..."
chown -R sasi:sasi /opt/sasi/
chmod 755 /opt/sasi/
chmod 700 /opt/sasi/data/

# 6. Start services
echo "Starting services..."
sudo systemctl start nginx
pm2 start sasi-neural || systemctl start sasi-service

# 7. Verify recovery
echo "Verifying recovery..."
sleep 10
if curl -f http://localhost:3000/health >/dev/null 2>&1; then
    echo "‚úÖ Recovery successful"
else
    echo "‚ùå Recovery failed - manual intervention required"
fi

echo "=== Recovery Complete ==="
```

### Data Recovery

#### Database Emergency Recovery
```bash
#!/bin/bash
# database-emergency-recovery.sh

DATABASE_PATH="/opt/sasi/data/neural.db"
BACKUP_DIR="/opt/sasi/backups"
RECOVERY_DIR="/tmp/database-recovery-$(date +%Y%m%d_%H%M%S)"

echo "=== Database Emergency Recovery ==="

# Create recovery directory
mkdir -p "$RECOVERY_DIR"

# 1. Attempt to salvage current database
echo "Attempting to salvage current database..."
if [ -f "$DATABASE_PATH" ]; then
    # Try to dump data
    sqlite3 "$DATABASE_PATH" ".dump" > "$RECOVERY_DIR/salvaged.sql" 2>/dev/null
    
    if [ -s "$RECOVERY_DIR/salvaged.sql" ]; then
        echo "‚úÖ Data salvaged to $RECOVERY_DIR/salvaged.sql"
    else
        echo "‚ùå Could not salvage current database"
    fi
fi

# 2. Find latest backup
LATEST_BACKUP=$(find "$BACKUP_DIR" -name "neural_backup_*.db.gz" -type f -printf '%T@ %p\n' | sort -n | tail -1 | cut -d' ' -f2-)

if [ -n "$LATEST_BACKUP" ]; then
    echo "Using backup: $LATEST_BACKUP"
    
    # Restore from backup
    gunzip -c "$LATEST_BACKUP" > "$RECOVERY_DIR/restored.db"
    
    # Verify backup integrity
    if sqlite3 "$RECOVERY_DIR/restored.db" "PRAGMA integrity_check;" | grep -q "ok"; then
        echo "‚úÖ Backup integrity verified"
        
        # Stop application
        pm2 stop sasi-neural 2>/dev/null || systemctl stop sasi-service
        
        # Replace database
        cp "$DATABASE_PATH" "$RECOVERY_DIR/original.db.backup" 2>/dev/null
        cp "$RECOVERY_DIR/restored.db" "$DATABASE_PATH"
        
        # Fix permissions
        chown sasi:sasi "$DATABASE_PATH"
        chmod 660 "$DATABASE_PATH"
        
        # Start application
        pm2 start sasi-neural || systemctl start sasi-service
        
        echo "‚úÖ Database recovery complete"
    else
        echo "‚ùå Backup is corrupted"
    fi
else
    echo "‚ùå No backups found"
fi

echo "Recovery files saved to: $RECOVERY_DIR"
```

### Performance Emergency

#### High Load Recovery
```bash
#!/bin/bash
# performance-emergency.sh

echo "=== Performance Emergency Recovery ==="

# 1. Get current system state
echo "Current system state:"
echo "Memory: $(free -m | grep Mem | awk '{printf "%.1f%%", $3/$2 * 100.0}')"
echo "CPU Load: $(uptime | awk -F'load average:' '{ print $2 }' | awk '{ print $1 }' | sed 's/,//')"
echo "Disk: $(df / | tail -1 | awk '{print $5}')"

# 2. Emergency agent cleanup
echo "Performing emergency agent cleanup..."
curl -X DELETE "http://localhost:3000/api/agents/bulk-remove" \
  -H "Content-Type: application/json" \
  -d '{"filter": {"status": "idle"}}' 2>/dev/null

# Limit active agents
curl -X POST "http://localhost:3000/api/system/emergency-mode" \
  -H "Content-Type: application/json" \
  -d '{"maxAgents": 5, "enablePerformanceMode": true}' 2>/dev/null

# 3. Clear caches
echo "Clearing caches..."
curl -X POST "http://localhost:3000/api/system/clear-cache" 2>/dev/null

# 4. Restart with minimal configuration
echo "Restarting with emergency configuration..."
export NEURAL_MAX_AGENTS=5
export NEURAL_MEMORY_LIMIT=30
export PERFORMANCE_MODE=emergency

pm2 restart sasi-neural --update-env

# 5. Monitor recovery
echo "Monitoring recovery..."
for i in {1..30}; do
    if curl -f http://localhost:3000/health >/dev/null 2>&1; then
        echo "‚úÖ System responding after ${i} seconds"
        break
    fi
    echo "Waiting... (${i}/30)"
    sleep 1
done

echo "=== Emergency Recovery Complete ==="
```

## üîß Diagnostic Tools

### System Health Script

```bash
#!/bin/bash
# sasi-health-check.sh - Comprehensive system diagnostics

echo "=== SASI System Health Check ==="
echo "Timestamp: $(date)"
echo "Hostname: $(hostname)"
echo

# Function to check command availability
check_command() {
    if command -v $1 >/dev/null 2>&1; then
        echo "‚úÖ $1 available"
        return 0
    else
        echo "‚ùå $1 not found"
        return 1
    fi
}

# Function to check service status
check_service() {
    local service=$1
    local endpoint=$2
    
    if curl -f -s "$endpoint" >/dev/null 2>&1; then
        echo "‚úÖ $service: Running"
    else
        echo "‚ùå $service: Not responding"
    fi
}

# 1. System Information
echo "üñ•Ô∏è  System Information:"
echo "   OS: $(uname -a)"
echo "   Uptime: $(uptime | awk -F'up ' '{print $2}' | awk -F',' '{print $1}')"
echo "   Users: $(who | wc -l) logged in"
echo

# 2. Hardware Resources
echo "üíæ Hardware Resources:"
memory_total=$(free -m | grep Mem | awk '{print $2}')
memory_used=$(free -m | grep Mem | awk '{print $3}')
memory_percent=$(echo "$memory_used $memory_total" | awk '{printf "%.1f", $1/$2*100}')

disk_usage=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
load_avg=$(uptime | awk -F'load average:' '{print $2}' | awk '{print $1}' | sed 's/,//')

echo "   Memory: ${memory_used}MB / ${memory_total}MB (${memory_percent}%)"
echo "   Disk: ${disk_usage}% used"
echo "   Load Average: ${load_avg}"
echo

# 3. Required Commands
echo "üîß Required Tools:"
check_command curl
check_command sqlite3
check_command node
check_command npm
check_command pm2
echo

# 4. Service Status
echo "üöÄ Service Status:"
check_service "SASI Application" "http://localhost:3000/health"
check_service "API Endpoint" "http://localhost:3000/api/metrics"

# Check PM2 if available
if command -v pm2 >/dev/null 2>&1; then
    pm2_status=$(pm2 jlist 2>/dev/null | jq -r '.[] | select(.name=="sasi-neural") | .pm2_env.status' 2>/dev/null)
    if [ "$pm2_status" = "online" ]; then
        echo "‚úÖ PM2: sasi-neural online"
    else
        echo "‚ùå PM2: sasi-neural not running"
    fi
fi
echo

# 5. Database Check
echo "üóÑÔ∏è  Database Status:"
if [ -f "/opt/sasi/data/neural.db" ]; then
    echo "‚úÖ Database file exists"
    
    # Check database integrity
    integrity_check=$(sqlite3 /opt/sasi/data/neural.db "PRAGMA integrity_check;" 2>/dev/null)
    if [ "$integrity_check" = "ok" ]; then
        echo "‚úÖ Database integrity: OK"
    else
        echo "‚ùå Database integrity: FAILED"
    fi
    
    # Count records
    agent_count=$(sqlite3 /opt/sasi/data/neural.db "SELECT COUNT(*) FROM neural_agents;" 2>/dev/null)
    event_count=$(sqlite3 /opt/sasi/data/neural.db "SELECT COUNT(*) FROM neural_events;" 2>/dev/null)
    
    echo "   Agents: ${agent_count:-0}"
    echo "   Events: ${event_count:-0}"
else
    echo "‚ùå Database file not found"
fi
echo

# 6. Network Connectivity
echo "üåê Network Status:"
if ping -c 1 8.8.8.8 >/dev/null 2>&1; then
    echo "‚úÖ Internet connectivity"
else
    echo "‚ùå No internet connectivity"
fi

if netstat -tlnp 2>/dev/null | grep -q ":3000"; then
    echo "‚úÖ Port 3000 listening"
else
    echo "‚ùå Port 3000 not listening"
fi
echo

# 7. Performance Metrics
echo "‚ö° Performance Metrics:"
if curl -f -s http://localhost:3000/api/metrics >/dev/null 2>&1; then
    metrics=$(curl -s http://localhost:3000/api/metrics 2>/dev/null)
    
    health_score=$(echo "$metrics" | jq -r '.systemMetrics.systemHealth // 0' 2>/dev/null)
    avg_inference=$(echo "$metrics" | jq -r '.systemMetrics.averageInferenceTime // 0' 2>/dev/null)
    total_agents=$(echo "$metrics" | jq -r '.systemMetrics.totalAgents // 0' 2>/dev/null)
    
    echo "   Health Score: $(echo "$health_score" | awk '{printf "%.1f%%", $1*100}')"
    echo "   Avg Inference: ${avg_inference}ms"
    echo "   Active Agents: ${total_agents}"
else
    echo "‚ùå Performance metrics not available"
fi
echo

# 8. Log Analysis
echo "üìù Recent Log Analysis:"
log_file="/opt/sasi/logs/sasi.log"
if [ -f "$log_file" ]; then
    echo "‚úÖ Log file exists"
    
    # Count recent errors
    error_count=$(tail -1000 "$log_file" | grep -c "ERROR" 2>/dev/null || echo "0")
    warning_count=$(tail -1000 "$log_file" | grep -c "WARN" 2>/dev/null || echo "0")
    
    echo "   Recent Errors: ${error_count}"
    echo "   Recent Warnings: ${warning_count}"
    
    # Show last few log entries
    echo "   Last 3 log entries:"
    tail -3 "$log_file" 2>/dev/null | sed 's/^/     /' || echo "     (no recent logs)"
else
    echo "‚ùå Log file not found"
fi
echo

# 9. Security Check
echo "üîí Security Status:"
if [ -f "/etc/ssl/certs/sasi.crt" ]; then
    cert_expiry=$(openssl x509 -in /etc/ssl/certs/sasi.crt -noout -enddate 2>/dev/null | cut -d= -f2)
    echo "‚úÖ SSL certificate present"
    echo "   Expires: ${cert_expiry}"
else
    echo "‚ùå SSL certificate not found"
fi

# Check firewall
if command -v ufw >/dev/null 2>&1; then
    ufw_status=$(sudo ufw status | head -1 | awk '{print $2}')
    echo "   Firewall: ${ufw_status}"
fi
echo

# 10. Backup Status
echo "üíæ Backup Status:"
backup_dir="/opt/sasi/backups"
if [ -d "$backup_dir" ]; then
    backup_count=$(find "$backup_dir" -name "*.db.gz" | wc -l)
    if [ "$backup_count" -gt 0 ]; then
        latest_backup=$(find "$backup_dir" -name "*.db.gz" -printf '%T@ %p\n' | sort -n | tail -1 | cut -d' ' -f2-)
        backup_date=$(stat -c %y "$latest_backup" 2>/dev/null | cut -d' ' -f1)
        echo "‚úÖ Backups available: ${backup_count}"
        echo "   Latest: ${backup_date}"
    else
        echo "‚ùå No backups found"
    fi
else
    echo "‚ùå Backup directory not found"
fi
echo

# 11. Overall Assessment
echo "üéØ Overall Assessment:"
total_checks=0
passed_checks=0

# Count checks (simplified)
if curl -f -s http://localhost:3000/health >/dev/null 2>&1; then
    ((passed_checks++))
fi
((total_checks++))

if [ "$memory_percent" != "" ] && [ "${memory_percent%.*}" -lt 80 ]; then
    ((passed_checks++))
fi
((total_checks++))

if [ "$disk_usage" -lt 80 ]; then
    ((passed_checks++))
fi
((total_checks++))

if [ -f "/opt/sasi/data/neural.db" ]; then
    ((passed_checks++))
fi
((total_checks++))

health_percentage=$(echo "$passed_checks $total_checks" | awk '{printf "%.0f", $1/$2*100}')

if [ "$health_percentage" -ge 80 ]; then
    echo "‚úÖ System Health: GOOD (${health_percentage}%)"
elif [ "$health_percentage" -ge 60 ]; then
    echo "‚ö†Ô∏è  System Health: FAIR (${health_percentage}%)"
else
    echo "‚ùå System Health: POOR (${health_percentage}%)"
fi

echo
echo "=== Health Check Complete ==="
echo "Run this script regularly to monitor system health."
echo "For issues, check the troubleshooting guide or contact support."
```

### Performance Monitor Script

```bash
#!/bin/bash
# sasi-performance-monitor.sh - Real-time performance monitoring

echo "=== SASI Performance Monitor ==="
echo "Press Ctrl+C to stop"
echo

# Function to get metrics
get_metrics() {
    local timestamp=$(date '+%H:%M:%S')
    
    # System metrics
    local memory_usage=$(free | grep Mem | awk '{printf "%.1f", $3/$2 * 100.0}')
    local cpu_load=$(uptime | awk -F'load average:' '{ print $2 }' | awk '{ print $1 }' | sed 's/,//')
    local disk_usage=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
    
    # Application metrics
    local app_metrics=""
    if curl -f -s http://localhost:3000/api/metrics >/dev/null 2>&1; then
        app_metrics=$(curl -s http://localhost:3000/api/metrics 2>/dev/null)
        local health_score=$(echo "$app_metrics" | jq -r '.systemMetrics.systemHealth // 0' 2>/dev/null)
        local avg_inference=$(echo "$app_metrics" | jq -r '.systemMetrics.averageInferenceTime // 0' 2>/dev/null)
        local total_agents=$(echo "$app_metrics" | jq -r '.systemMetrics.totalAgents // 0' 2>/dev/null)
        local memory_mb=$(echo "$app_metrics" | jq -r '.systemMetrics.totalMemoryUsage // 0' 2>/dev/null)
        
        printf "%s | CPU: %4s | Mem: %5.1f%% | Disk: %3s%% | Health: %5.1f%% | Agents: %2s | Inference: %4sms | App Mem: %5sMB\n" \
            "$timestamp" "$cpu_load" "$memory_usage" "$disk_usage" \
            "$(echo "$health_score" | awk '{printf "%.1f", $1*100}')" \
            "$total_agents" "$avg_inference" "$memory_mb"
    else
        printf "%s | CPU: %4s | Mem: %5.1f%% | Disk: %3s%% | App: OFFLINE\n" \
            "$timestamp" "$cpu_load" "$memory_usage" "$disk_usage"
    fi
}

# Header
echo "Time     | CPU Load | Memory | Disk | Health | Agents | Inference | App Memory"
echo "---------|----------|--------|------|--------|--------|-----------|----------"

# Monitor loop
while true; do
    get_metrics
    sleep 5
done
```

## üìû Getting Help

### Self-Help Resources

#### 1. Built-in Diagnostics
```bash
# Run health check
curl http://localhost:3000/health

# Get detailed metrics
curl http://localhost:3000/api/metrics | jq

# Check system status
curl http://localhost:3000/api/status | jq
```

#### 2. Log Analysis
```bash
# View recent logs
tail -100 /path/to/sasi/logs/sasi.log

# Search for errors
grep -i "error\|fail\|exception" /path/to/sasi/logs/sasi.log | tail -20

# Performance issues
grep -i "performance\|slow\|timeout" /path/to/sasi/logs/sasi.log | tail -20
```

#### 3. Documentation
- **User Guide**: Comprehensive usage instructions
- **API Reference**: Complete API documentation
- **Deployment Guide**: Production deployment procedures
- **Technical Documentation**: System architecture and internals

### Community Support

#### Forums and Discussion
- **Community Forum**: https://community.sasi.example.com
- **GitHub Issues**: https://github.com/sasi/neural-agents/issues
- **Stack Overflow**: Tag questions with `sasi-neural-agents`
- **Discord/Slack**: Real-time community chat

#### Knowledge Base
- **FAQ**: Common questions and answers
- **Troubleshooting Articles**: Step-by-step problem resolution
- **Best Practices**: Optimization guides and tips
- **Video Tutorials**: Visual learning resources

### Professional Support

#### Support Tiers

**Community Support (Free):**
- Community forums and discussions
- Public documentation and guides
- GitHub issue tracking
- Basic troubleshooting assistance

**Professional Support (Paid):**
- Direct technical support
- Priority issue resolution
- Performance optimization consultation
- Custom integration assistance

**Enterprise Support (Paid):**
- 24/7 technical support
- Dedicated support engineer
- Custom development and integration
- On-site consultation and training

#### Contact Information

**General Support:**
- Email: support@sasi.example.com
- Response: Within 24 hours

**Technical Issues:**
- Email: technical@sasi.example.com
- Response: Within 12 hours (Professional), 4 hours (Enterprise)

**Performance Issues:**
- Email: performance@sasi.example.com
- Response: Within 8 hours (Professional), 2 hours (Enterprise)

**Emergency Support (Enterprise only):**
- Phone: +1-XXX-XXX-XXXX
- Response: Within 1 hour

#### Information to Include

When contacting support, please include:

1. **System Information:**
   - SASI version (e.g., 2.0.0-phase2b)
   - Operating system and version
   - Browser type and version (for UI issues)
   - Deployment method (Docker, K8s, manual)

2. **Problem Description:**
   - Clear description of the issue
   - Steps to reproduce the problem
   - Expected vs. actual behavior
   - When the problem started

3. **Diagnostic Information:**
   - Health check results
   - Recent log entries
   - Performance metrics
   - Error messages

4. **System State:**
   - Number of active agents
   - Memory and CPU usage
   - Recent configuration changes
   - Any related system changes

#### Escalation Path

1. **Level 1**: Community support and documentation
2. **Level 2**: Professional technical support
3. **Level 3**: Senior engineering team
4. **Level 4**: Development team escalation

### Emergency Support

#### When to Use Emergency Support
- System completely down in production
- Data loss or corruption
- Security incidents
- Critical performance degradation affecting users

#### Emergency Response Process
1. **Immediate Response**: Initial contact within 1 hour
2. **Assessment**: Problem analysis and impact assessment
3. **Mitigation**: Immediate steps to reduce impact
4. **Resolution**: Permanent fix implementation
5. **Post-Incident Review**: Analysis and prevention measures

---

## üìö Additional Resources

### Training and Certification
- **SASI Administrator Certification**: System administration training
- **Neural Agent Development**: Advanced development techniques
- **Performance Optimization**: Specialized performance tuning
- **Security Best Practices**: Security configuration and management

### Integration Guides
- **CI/CD Integration**: Automated deployment pipelines
- **Monitoring Integration**: External monitoring systems
- **API Integration**: Custom application integration
- **Cloud Platform Guides**: AWS, GCP, Azure deployment

### Development Resources
- **SDK Documentation**: Language-specific SDKs
- **API Examples**: Sample implementations
- **Plugin Development**: Extending SASI functionality
- **Custom Agent Types**: Creating specialized agents

---

**Troubleshooting Guide Version:** 2.0.0-phase2b  
**Last Updated:** 2025-07-18  
**Next Review:** 2025-08-18  
**Generated by:** DocsEngineer Agent - SASI Neural Agent Swarm

*Remember: Most issues can be resolved quickly with proper diagnostics. When in doubt, check the logs first!*