c048c2f44c2d53e6aae28bbba839290c
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = __importStar(require("react"));
const McpService_1 = require("../services/McpService");
require("../styles/McpToolsDashboard.css");
const McpToolsDashboard = () => {
    const [servers, setServers] = (0, react_1.useState)([]);
    const [selectedServer, setSelectedServer] = (0, react_1.useState)(null);
    const [metrics, setMetrics] = (0, react_1.useState)(null);
    const [isLoading, setIsLoading] = (0, react_1.useState)(true);
    const [toolFilter, setToolFilter] = (0, react_1.useState)('');
    const [selectedTool, setSelectedTool] = (0, react_1.useState)(null);
    const [executionResults, setExecutionResults] = (0, react_1.useState)([]);
    const [isExecuting, setIsExecuting] = (0, react_1.useState)(false);
    (0, react_1.useEffect)(() => {
        // Initialize MCP server discovery
        initializeMcpDiscovery();
        // Set up periodic health checks
        const healthCheckInterval = setInterval(() => {
            performHealthChecks();
        }, 30000); // Check every 30 seconds
        return () => clearInterval(healthCheckInterval);
    }, []);
    const initializeMcpDiscovery = async () => {
        try {
            setIsLoading(true);
            // Initialize MCP service
            await McpService_1.mcpService.initialize();
            // Get discovered servers
            const discoveredServers = McpService_1.mcpService.getServers();
            setServers(discoveredServers);
            // Get metrics
            const currentMetrics = McpService_1.mcpService.getMetrics();
            setMetrics(currentMetrics);
        }
        catch (error) {
            console.error('Failed to initialize MCP discovery:', error);
        }
        finally {
            setIsLoading(false);
        }
    };
    const refreshServers = async () => {
        try {
            const updatedServers = await McpService_1.mcpService.refreshServers();
            setServers(updatedServers);
            const currentMetrics = McpService_1.mcpService.getMetrics();
            setMetrics(currentMetrics);
        }
        catch (error) {
            console.error('Failed to refresh servers:', error);
        }
    };
    const updateMetrics = async () => {
        try {
            const currentMetrics = McpService_1.mcpService.getMetrics();
            setMetrics(currentMetrics);
        }
        catch (error) {
            console.error('Failed to update metrics:', error);
        }
    };
    const performHealthChecks = async () => {
        try {
            // Get updated servers from service
            const updatedServers = McpService_1.mcpService.getServers();
            setServers(updatedServers);
            const currentMetrics = McpService_1.mcpService.getMetrics();
            setMetrics(currentMetrics);
        }
        catch (error) {
            console.error('Failed to perform health checks:', error);
        }
    };
    const executeTool = async (tool, parameters) => {
        if (!selectedServer)
            return;
        setIsExecuting(true);
        try {
            const result = await McpService_1.mcpService.executeTool(selectedServer, tool.name, parameters);
            setExecutionResults(prev => [result, ...prev.slice(0, 19)]); // Keep last 20 results
            // Refresh servers to get updated stats
            const updatedServers = McpService_1.mcpService.getServers();
            setServers(updatedServers);
            // Update metrics
            const currentMetrics = McpService_1.mcpService.getMetrics();
            setMetrics(currentMetrics);
        }
        catch (error) {
            console.error('Tool execution failed:', error);
            // Create error result
            const errorResult = {
                toolName: tool.name,
                parameters,
                timestamp: new Date(),
                success: false,
                response: null,
                duration: 0,
                error: error instanceof Error ? error.message : 'Unknown error'
            };
            setExecutionResults(prev => [errorResult, ...prev.slice(0, 19)]);
        }
        finally {
            setIsExecuting(false);
        }
    };
    const getServerStatusColor = (status) => {
        switch (status) {
            case 'connected': return '#4CAF50';
            case 'disconnected': return '#FF9800';
            case 'error': return '#F44336';
            default: return '#757575';
        }
    };
    const getHealthScoreColor = (score) => {
        if (score >= 90)
            return '#4CAF50';
        if (score >= 70)
            return '#FF9800';
        return '#F44336';
    };
    const filteredTools = selectedServer
        ? servers.find(s => s.id === selectedServer)?.tools?.filter(tool => tool.name.toLowerCase().includes(toolFilter.toLowerCase()) ||
            tool.description.toLowerCase().includes(toolFilter.toLowerCase()) ||
            tool.category.toLowerCase().includes(toolFilter.toLowerCase())) || []
        : [];
    if (isLoading) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "mcp-dashboard loading", children: (0, jsx_runtime_1.jsxs)("div", { className: "loading-spinner", children: [(0, jsx_runtime_1.jsx)("div", { className: "spinner" }), (0, jsx_runtime_1.jsx)("p", { children: "Discovering MCP servers..." })] }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "mcp-dashboard", children: [(0, jsx_runtime_1.jsxs)("div", { className: "mcp-header", children: [(0, jsx_runtime_1.jsx)("h2", { className: "mcp-title", children: "MCP Tools Dashboard" }), (0, jsx_runtime_1.jsxs)("div", { className: "mcp-metrics-summary", children: [(0, jsx_runtime_1.jsxs)("div", { className: "metric-item", children: [(0, jsx_runtime_1.jsx)("span", { className: "metric-label", children: "Servers" }), (0, jsx_runtime_1.jsx)("span", { className: "metric-value", children: servers.length })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-item", children: [(0, jsx_runtime_1.jsx)("span", { className: "metric-label", children: "Tools" }), (0, jsx_runtime_1.jsx)("span", { className: "metric-value", children: servers.reduce((sum, s) => sum + s.tools.length, 0) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-item", children: [(0, jsx_runtime_1.jsx)("span", { className: "metric-label", children: "Success Rate" }), (0, jsx_runtime_1.jsxs)("span", { className: "metric-value", children: [metrics ? ((metrics.successfulRequests / metrics.totalRequests) * 100).toFixed(1) : '0.0', "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "metric-item", children: [(0, jsx_runtime_1.jsx)("span", { className: "metric-label", children: "Avg Response" }), (0, jsx_runtime_1.jsxs)("span", { className: "metric-value", children: [metrics ? metrics.averageResponseTime : 0, "ms"] })] })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "mcp-content", children: [(0, jsx_runtime_1.jsxs)("div", { className: "mcp-sidebar", children: [(0, jsx_runtime_1.jsx)("h3", { children: "MCP Servers" }), (0, jsx_runtime_1.jsx)("div", { className: "server-list", children: servers.map(server => ((0, jsx_runtime_1.jsxs)("div", { className: `server-item ${selectedServer === server.id ? 'selected' : ''}`, onClick: () => setSelectedServer(server.id), children: [(0, jsx_runtime_1.jsxs)("div", { className: "server-header", children: [(0, jsx_runtime_1.jsx)("div", { className: "server-name", children: server.name }), (0, jsx_runtime_1.jsx)("div", { className: "server-status", style: { backgroundColor: getServerStatusColor(server.status) } })] }), (0, jsx_runtime_1.jsxs)("div", { className: "server-details", children: [(0, jsx_runtime_1.jsxs)("div", { className: "server-version", children: ["v", server.version] }), (0, jsx_runtime_1.jsx)("div", { className: "server-type", children: server.type })] }), (0, jsx_runtime_1.jsxs)("div", { className: "server-health", children: [(0, jsx_runtime_1.jsxs)("div", { className: "health-score", style: { color: getHealthScoreColor(server.healthScore) }, children: [server.healthScore.toFixed(0), "%"] }), (0, jsx_runtime_1.jsx)("div", { className: "health-bar", children: (0, jsx_runtime_1.jsx)("div", { className: "health-fill", style: {
                                                            width: `${server.healthScore}%`,
                                                            backgroundColor: getHealthScoreColor(server.healthScore)
                                                        } }) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "server-tools-count", children: [server.tools.length, " tools"] })] }, server.id))) })] }), (0, jsx_runtime_1.jsx)("div", { className: "mcp-main", children: selectedServer ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)("div", { className: "tools-header", children: [(0, jsx_runtime_1.jsxs)("h3", { children: ["Tools for ", servers.find(s => s.id === selectedServer)?.name] }), (0, jsx_runtime_1.jsx)("input", { type: "text", placeholder: "Filter tools...", value: toolFilter, onChange: (e) => setToolFilter(e.target.value), className: "tool-filter" })] }), (0, jsx_runtime_1.jsx)("div", { className: "tools-grid", children: filteredTools.map((tool, index) => ((0, jsx_runtime_1.jsxs)("div", { className: `tool-card ${selectedTool?.name === tool.name ? 'selected' : ''}`, onClick: () => setSelectedTool(tool), children: [(0, jsx_runtime_1.jsxs)("div", { className: "tool-header", children: [(0, jsx_runtime_1.jsx)("h4", { className: "tool-name", children: tool.name }), (0, jsx_runtime_1.jsx)("span", { className: "tool-category", children: tool.category })] }), (0, jsx_runtime_1.jsx)("p", { className: "tool-description", children: tool.description }), (0, jsx_runtime_1.jsxs)("div", { className: "tool-stats", children: [(0, jsx_runtime_1.jsxs)("div", { className: "stat", children: [(0, jsx_runtime_1.jsx)("span", { className: "stat-label", children: "Usage:" }), (0, jsx_runtime_1.jsx)("span", { className: "stat-value", children: tool.usageCount })] }), (0, jsx_runtime_1.jsxs)("div", { className: "stat", children: [(0, jsx_runtime_1.jsx)("span", { className: "stat-label", children: "Success:" }), (0, jsx_runtime_1.jsxs)("span", { className: "stat-value", children: [tool.successRate.toFixed(1), "%"] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "stat", children: [(0, jsx_runtime_1.jsx)("span", { className: "stat-label", children: "Avg Time:" }), (0, jsx_runtime_1.jsxs)("span", { className: "stat-value", children: [tool.averageResponseTime, "ms"] })] })] }), tool.lastUsed && ((0, jsx_runtime_1.jsxs)("div", { className: "tool-last-used", children: ["Last used: ", tool.lastUsed.toLocaleTimeString()] }))] }, index))) })] })) : ((0, jsx_runtime_1.jsxs)("div", { className: "no-server-selected", children: [(0, jsx_runtime_1.jsx)("h3", { children: "Select a server to view its tools" }), (0, jsx_runtime_1.jsx)("p", { children: "Choose an MCP server from the sidebar to explore its available tools and performance metrics." })] })) }), selectedTool && ((0, jsx_runtime_1.jsxs)("div", { className: "mcp-execution-panel", children: [(0, jsx_runtime_1.jsxs)("h3", { children: ["Execute Tool: ", selectedTool.name] }), (0, jsx_runtime_1.jsxs)("div", { className: "execution-form", children: [(0, jsx_runtime_1.jsxs)("div", { className: "parameters-section", children: [(0, jsx_runtime_1.jsx)("h4", { children: "Parameters" }), (0, jsx_runtime_1.jsx)("div", { className: "parameters-grid", children: Object.entries(selectedTool.parameters).map(([key, type]) => ((0, jsx_runtime_1.jsxs)("div", { className: "parameter-input", children: [(0, jsx_runtime_1.jsx)("label", { children: key }), (0, jsx_runtime_1.jsx)("input", { type: type === 'number' ? 'number' : 'text', placeholder: `Enter ${key} (${type})`, className: "parameter-field" })] }, key))) })] }), (0, jsx_runtime_1.jsx)("button", { className: "execute-button", onClick: () => executeTool(selectedTool, {}), disabled: isExecuting, children: isExecuting ? 'Executing...' : 'Execute Tool' })] }), executionResults.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "execution-results", children: [(0, jsx_runtime_1.jsx)("h4", { children: "Recent Executions" }), (0, jsx_runtime_1.jsx)("div", { className: "results-list", children: executionResults.slice(0, 5).map((result, index) => ((0, jsx_runtime_1.jsxs)("div", { className: `result-item ${result.success ? 'success' : 'error'}`, children: [(0, jsx_runtime_1.jsxs)("div", { className: "result-header", children: [(0, jsx_runtime_1.jsx)("span", { className: "result-tool", children: result.toolName }), (0, jsx_runtime_1.jsx)("span", { className: "result-time", children: result.timestamp.toLocaleTimeString() }), (0, jsx_runtime_1.jsxs)("span", { className: "result-duration", children: [result.duration, "ms"] })] }), (0, jsx_runtime_1.jsx)("div", { className: "result-response", children: result.response })] }, index))) })] }))] }))] })] }));
};
exports.default = McpToolsDashboard;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL3dvcmtzcGFjZXMvYWdlbnRpc3RzLXF1aWNrc3RhcnQtd29ya3NwYWNlLWJhc2ljL3Nhc2kvc3JjL2NvbXBvbmVudHMvTWNwVG9vbHNEYXNoYm9hcmQudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLCtDQUFrRDtBQUNsRCx1REFBdUc7QUFDdkcsMkNBQXdDO0FBR3hDLE1BQU0saUJBQWlCLEdBQWEsR0FBRyxFQUFFO0lBQ3ZDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFjLEVBQUUsQ0FBQyxDQUFBO0lBQ3ZELE1BQU0sQ0FBQyxjQUFjLEVBQUUsaUJBQWlCLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQWdCLElBQUksQ0FBQyxDQUFBO0lBQ3pFLE1BQU0sQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFvQixJQUFJLENBQUMsQ0FBQTtJQUMvRCxNQUFNLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQTtJQUNoRCxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQTtJQUNoRCxNQUFNLENBQUMsWUFBWSxFQUFFLGVBQWUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBaUIsSUFBSSxDQUFDLENBQUE7SUFDdEUsTUFBTSxDQUFDLGdCQUFnQixFQUFFLG1CQUFtQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUF1QixFQUFFLENBQUMsQ0FBQTtJQUNsRixNQUFNLENBQUMsV0FBVyxFQUFFLGNBQWMsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQTtJQUVyRCxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ2Isa0NBQWtDO1FBQ2xDLHNCQUFzQixFQUFFLENBQUE7UUFFeEIsZ0NBQWdDO1FBQ2hDLE1BQU0sbUJB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Q3RELGlDQUFNLFNBQVMsRUFBQyxhQUFhLFlBQUUsTUFBTSxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsRUFBRSxHQUFRLEVBQzVFLGtDQUFNLFNBQVMsRUFBQyxpQkFBaUIsYUFBRSxNQUFNLENBQUMsUUFBUSxVQUFVLElBQ3hELEVBQ04sZ0NBQUssU0FBUyxFQUFDLGlCQUFpQixZQUFFLE1BQU0sQ0FBQyxRQUFRLEdBQU8sS0FOaEQsS0FBSyxDQU9ULENBQ1AsQ0FBQyxHQUNFLElBQ0YsQ0FDUCxJQUNHLENBQ1AsSUFDRyxJQUNGLENBQ1AsQ0FBQTtBQUNILENBQUMsQ0FBQTtBQUVELGtCQUFlLGlCQUFpQixDQUFBIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2VzL2FnZW50aXN0cy1xdWlja3N0YXJ0LXdvcmtzcGFjZS1iYXNpYy9zYXNpL3NyYy9jb21wb25lbnRzL01jcFRvb2xzRGFzaGJvYXJkLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgbWNwU2VydmljZSwgTWNwU2VydmVyLCBNY3BUb29sLCBNY3BNZXRyaWNzLCBNY3BFeGVjdXRpb25SZXN1bHQgfSBmcm9tICcuLi9zZXJ2aWNlcy9NY3BTZXJ2aWNlJ1xuaW1wb3J0ICcuLi9zdHlsZXMvTWNwVG9vbHNEYXNoYm9hcmQuY3NzJ1xuXG5cbmNvbnN0IE1jcFRvb2xzRGFzaGJvYXJkOiBSZWFjdC5GQyA9ICgpID0+IHtcbiAgY29uc3QgW3NlcnZlcnMsIHNldFNlcnZlcnNdID0gdXNlU3RhdGU8TWNwU2VydmVyW10+KFtdKVxuICBjb25zdCBbc2VsZWN0ZWRTZXJ2ZXIsIHNldFNlbGVjdGVkU2VydmVyXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpXG4gIGNvbnN0IFttZXRyaWNzLCBzZXRNZXRyaWNzXSA9IHVzZVN0YXRlPE1jcE1ldHJpY3MgfCBudWxsPihudWxsKVxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSlcbiAgY29uc3QgW3Rvb2xGaWx0ZXIsIHNldFRvb2xGaWx0ZXJdID0gdXNlU3RhdGUoJycpXG4gIGNvbnN0IFtzZWxlY3RlZFRvb2wsIHNldFNlbGVjdGVkVG9vbF0gPSB1c2VTdGF0ZTxNY3BUb29sIHwgbnVsbD4obnVsbClcbiAgY29uc3QgW2V4ZWN1dGlvblJlc3VsdHMsIHNldEV4ZWN1dGlvblJlc3VsdHNdID0gdXNlU3RhdGU8TWNwRXhlY3V0aW9uUmVzdWx0W10+KFtdKVxuICBjb25zdCBbaXNFeGVjdXRpbmcsIHNldElzRXhlY3V0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gSW5pdGlhbGl6ZSBNQ1Agc2VydmVyIGRpc2NvdmVyeVxuICAgIGluaXRpYWxpemVNY3BEaXNjb3ZlcnkoKVxuICAgIFxuICAgIC8vIFNldCB1cCBwZXJpb2RpYyBoZWFsdGggY2hlY2tzXG4gICAgY29uc3QgaGVhbHRoQ2hlY2tJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHBlcmZvcm1IZWFsdGhDaGVja3MoKVxuICAgIH0sIDMwMDAwKSAvLyBDaGVjayBldmVyeSAzMCBzZWNvbmRzXG5cbiAgICByZXR1cm4gKCkgPT4gY2xlYXJJbnRlcnZhbChoZWFsdGhDaGVja0ludGVydmFsKVxuICB9LCBbXSlcblxuICBjb25zdCBpbml0aWFsaXplTWNwRGlzY292ZXJ5ID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBzZXRJc0xvYWRpbmcodHJ1ZSlcbiAgICAgIFxuICAgICAgLy8gSW5pdGlhbGl6ZSBNQ1Agc2VydmljZVxuICAgICAgYXdhaXQgbWNwU2VydmljZS5pbml0aWFsaXplKClcbiAgICAgIFxuICAgICAgLy8gR2V0IGRpc2NvdmVyZWQgc2VydmVyc1xuICAgICAgY29uc3QgZGlzY292ZXJlZFNlcnZlcnMgPSBtY3BTZXJ2aWNlLmdldFNlcnZlcnMoKVxuICAgICAgc2V0U2VydmVycyhkaXNjb3ZlcmVkU2VydmVycylcbiAgICAgIFxuICAgICAgLy8gR2V0IG1ldHJpY3NcbiAgICAgIGNvbnN0IGN1cnJlbnRNZXRyaWNzID0gbWNwU2VydmljZS5nZXRNZXRyaWNzKClcbiAgICAgIHNldE1ldHJpY3MoY3VycmVudE1ldHJpY3MpXG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgTUNQIGRpc2NvdmVyeTonLCBlcnJvcilcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlZnJlc2hTZXJ2ZXJzID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cGRhdGVkU2VydmVycyA9IGF3YWl0IG1jcFNlcnZpY2UucmVmcmVzaFNlcnZlcnMoKVxuICAgICAgc2V0U2VydmVycyh1cGRhdGVkU2VydmVycylcbiAgICAgIFxuICAgICAgY29uc3QgY3VycmVudE1ldHJpY3MgPSBtY3BTZXJ2aWNlLmdldE1ldHJpY3MoKVxuICAgICAgc2V0TWV0cmljcyhjdXJyZW50TWV0cmljcylcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHJlZnJlc2ggc2VydmVyczonLCBlcnJvcilcbiAgICB9XG4gIH1cblxuICBjb25zdCB1cGRhdGVNZXRyaWNzID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjdXJyZW50TWV0cmljcyA9IG1jcFNlcnZpY2UuZ2V0TWV0cmljcygpXG4gICAgICBzZXRNZXRyaWNzKGN1cnJlbnRNZXRyaWNzKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gdXBkYXRlIG1ldHJpY3M6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgcGVyZm9ybUhlYWx0aENoZWNrcyA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IHVwZGF0ZWQgc2VydmVycyBmcm9tIHNlcnZpY2VcbiAgICAgIGNvbnN0IHVwZGF0ZWRTZXJ2ZXJzID0gbWNwU2VydmljZS5nZXRTZXJ2ZXJzKClcbiAgICAgIHNldFNlcnZlcnModXBkYXRlZFNlcnZlcnMpXG4gICAgICBcbiAgICAgIGNvbnN0IGN1cnJlbnRNZXRyaWNzID0gbWNwU2VydmljZS5nZXRNZXRyaWNzKClcbiAgICAgIHNldE1ldHJpY3MoY3VycmVudE1ldHJpY3MpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwZXJmb3JtIGhlYWx0aCBjaGVja3M6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZXhlY3V0ZVRvb2wgPSBhc3luYyAodG9vbDogTWNwVG9vbCwgcGFyYW1ldGVyczogUmVjb3JkPHN0cmluZywgYW55PikgPT4ge1xuICAgIGlmICghc2VsZWN0ZWRTZXJ2ZXIpIHJldHVyblxuICAgIFxuICAgIHNldElzRXhlY3V0aW5nKHRydWUpXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1jcFNlcnZpY2UuZXhlY3V0ZVRvb2woc2VsZWN0ZWRTZXJ2ZXIsIHRvb2wubmFtZSwgcGFyYW1ldGVycylcbiAgICAgIFxuICAgICAgc2V0RXhlY3V0aW9uUmVzdWx0cyhwcmV2ID0+IFtyZXN1bHQsIC4uLnByZXYuc2xpY2UoMCwgMTkpXSkgLy8gS2VlcCBsYXN0IDIwIHJlc3VsdHNcbiAgICAgIFxuICAgICAgLy8gUmVmcmVzaCBzZXJ2ZXJzIHRvIGdldCB1cGRhdGVkIHN0YXRzXG4gICAgICBjb25zdCB1cGRhdGVkU2VydmVycyA9IG1jcFNlcnZpY2UuZ2V0U2VydmVycygpXG4gICAgICBzZXRTZXJ2ZXJzKHVwZGF0ZWRTZXJ2ZXJzKVxuICAgICAgXG4gICAgICAvLyBVcGRhdGUgbWV0cmljc1xuICAgICAgY29uc3QgY3VycmVudE1ldHJpY3MgPSBtY3BTZXJ2aWNlLmdldE1ldHJpY3MoKVxuICAgICAgc2V0TWV0cmljcyhjdXJyZW50TWV0cmljcylcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUb29sIGV4ZWN1dGlvbiBmYWlsZWQ6JywgZXJyb3IpXG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBlcnJvciByZXN1bHRcbiAgICAgIGNvbnN0IGVycm9yUmVzdWx0OiBNY3BFeGVjdXRpb25SZXN1bHQgPSB7XG4gICAgICAgIHRvb2xOYW1lOiB0b29sLm5hbWUsXG4gICAgICAgIHBhcmFtZXRlcnMsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIHJlc3BvbnNlOiBudWxsLFxuICAgICAgICBkdXJhdGlvbjogMCxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICB9XG4gICAgICBcbiAgICAgIHNldEV4ZWN1dGlvblJlc3VsdHMocHJldiA9PiBbZXJyb3JSZXN1bHQsIC4uLnByZXYuc2xpY2UoMCwgMTkpXSlcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNFeGVjdXRpbmcoZmFsc2UpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZ2V0U2VydmVyU3RhdHVzQ29sb3IgPSAoc3RhdHVzOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHN3aXRjaCAoc3RhdHVzKSB7XG4gICAgICBjYXNlICdjb25uZWN0ZWQnOiByZXR1cm4gJyM0Q0FGNTAnXG4gICAgICBjYXNlICdkaXNjb25uZWN0ZWQnOiByZXR1cm4gJyNGRjk4MDAnXG4gICAgICBjYXNlICdlcnJvcic6IHJldHVybiAnI0Y0NDMzNidcbiAgICAgIGRlZmF1bHQ6IHJldHVybiAnIzc1NzU3NSdcbiAgICB9XG4gIH1cblxuICBjb25zdCBnZXRIZWFsdGhTY29yZUNvbG9yID0gKHNjb3JlOiBudW1iZXIpOiBzdHJpbmcgPT4ge1xuICAgIGlmIChzY29yZSA+PSA5MCkgcmV0dXJuICcjNENBRjUwJ1xuICAgIGlmIChzY29yZSA+PSA3MCkgcmV0dXJuICcjRkY5ODAwJ1xuICAgIHJldHVybiAnI0Y0NDMzNidcbiAgfVxuXG4gIGNvbnN0IGZpbHRlcmVkVG9vbHMgPSBzZWxlY3RlZFNlcnZlclxuICAgID8gc2VydmVycy5maW5kKHMgPT4gcy5pZCA9PT0gc2VsZWN0ZWRTZXJ2ZXIpPy50b29scz8uZmlsdGVyKHRvb2wgPT5cbiAgICAgICAgdG9vbC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModG9vbEZpbHRlci50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICB0b29sLmRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModG9vbEZpbHRlci50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICB0b29sLmNhdGVnb3J5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModG9vbEZpbHRlci50b0xvd2VyQ2FzZSgpKVxuICAgICAgKSB8fCBbXVxuICAgIDogW11cblxuICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWNwLWRhc2hib2FyZCBsb2FkaW5nXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibG9hZGluZy1zcGlubmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGlubmVyXCI+PC9kaXY+XG4gICAgICAgICAgPHA+RGlzY292ZXJpbmcgTUNQIHNlcnZlcnMuLi48L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIm1jcC1kYXNoYm9hcmRcIj5cbiAgICAgIHsvKiBIZWFkZXIgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1jcC1oZWFkZXJcIj5cbiAgICAgICAgPGgyIGNsYXNzTmFtZT1cIm1jcC10aXRsZVwiPk1DUCBUb29scyBEYXNoYm9hcmQ8L2gyPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1jcC1tZXRyaWNzLXN1bW1hcnlcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1ldHJpYy1pdGVtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJtZXRyaWMtbGFiZWxcIj5TZXJ2ZXJzPC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibWV0cmljLXZhbHVlXCI+e3NlcnZlcnMubGVuZ3RofTwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1ldHJpYy1pdGVtXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJtZXRyaWMtbGFiZWxcIj5Ub29sczwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1ldHJpYy12YWx1ZVwiPntzZXJ2ZXJzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLnRvb2xzLmxlbmd0aCwgMCl9PC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWV0cmljLWl0ZW1cIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1ldHJpYy1sYWJlbFwiPlN1Y2Nlc3MgUmF0ZTwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1ldHJpYy12YWx1ZVwiPlxuICAgICAgICAgICAgICB7bWV0cmljcyA/ICgobWV0cmljcy5zdWNjZXNzZnVsUmVxdWVzdHMgLyBtZXRyaWNzLnRvdGFsUmVxdWVzdHMpICogMTAwKS50b0ZpeGVkKDEpIDogJzAuMCd9JVxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWV0cmljLWl0ZW1cIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1ldHJpYy1sYWJlbFwiPkF2ZyBSZXNwb25zZTwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1ldHJpYy12YWx1ZVwiPnttZXRyaWNzID8gbWV0cmljcy5hdmVyYWdlUmVzcG9uc2VUaW1lIDogMH1tczwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIE1haW4gQ29udGVudCAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWNwLWNvbnRlbnRcIj5cbiAgICAgICAgey8qIFNlcnZlciBMaXN0ICovfVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1jcC1zaWRlYmFyXCI+XG4gICAgICAgICAgPGgzPk1DUCBTZXJ2ZXJzPC9oMz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlcnZlci1saXN0XCI+XG4gICAgICAgICAgICB7c2VydmVycy5tYXAoc2VydmVyID0+IChcbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGtleT17c2VydmVyLmlkfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHNlcnZlci1pdGVtICR7c2VsZWN0ZWRTZXJ2ZXIgPT09IHNlcnZlci5pZCA/ICdzZWxlY3RlZCcgOiAnJ31gfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFNlbGVjdGVkU2VydmVyKHNlcnZlci5pZCl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlcnZlci1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VydmVyLW5hbWVcIj57c2VydmVyLm5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInNlcnZlci1zdGF0dXNcIlxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBiYWNrZ3JvdW5kQ29sb3I6IGdldFNlcnZlclN0YXR1c0NvbG9yKHNlcnZlci5zdGF0dXMpIH19XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VydmVyLWRldGFpbHNcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VydmVyLXZlcnNpb25cIj52e3NlcnZlci52ZXJzaW9ufTwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZXJ2ZXItdHlwZVwiPntzZXJ2ZXIudHlwZX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlcnZlci1oZWFsdGhcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaGVhbHRoLXNjb3JlXCIgc3R5bGU9e3sgY29sb3I6IGdldEhlYWx0aFNjb3JlQ29sb3Ioc2VydmVyLmhlYWx0aFNjb3JlKSB9fT5cbiAgICAgICAgICAgICAgICAgICAge3NlcnZlci5oZWFsdGhTY29yZS50b0ZpeGVkKDApfSVcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoZWFsdGgtYmFyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoZWFsdGgtZmlsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBgJHtzZXJ2ZXIuaGVhbHRoU2NvcmV9JWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGdldEhlYWx0aFNjb3JlQ29sb3Ioc2VydmVyLmhlYWx0aFNjb3JlKVxuICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNlcnZlci10b29scy1jb3VudFwiPntzZXJ2ZXIudG9vbHMubGVuZ3RofSB0b29sczwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICB7LyogVG9vbCBEZXRhaWxzICovfVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1jcC1tYWluXCI+XG4gICAgICAgICAge3NlbGVjdGVkU2VydmVyID8gKFxuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0b29scy1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICA8aDM+VG9vbHMgZm9yIHtzZXJ2ZXJzLmZpbmQocyA9PiBzLmlkID09PSBzZWxlY3RlZFNlcnZlcik/Lm5hbWV9PC9oMz5cbiAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiRmlsdGVyIHRvb2xzLi4uXCJcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXt0b29sRmlsdGVyfVxuICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRUb29sRmlsdGVyKGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRvb2wtZmlsdGVyXCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG9vbHMtZ3JpZFwiPlxuICAgICAgICAgICAgICAgIHtmaWx0ZXJlZFRvb2xzLm1hcCgodG9vbCwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAga2V5PXtpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgdG9vbC1jYXJkICR7c2VsZWN0ZWRUb29sPy5uYW1lID09PSB0b29sLm5hbWUgPyAnc2VsZWN0ZWQnIDogJyd9YH1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2VsZWN0ZWRUb29sKHRvb2wpfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRvb2wtaGVhZGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT1cInRvb2wtbmFtZVwiPnt0b29sLm5hbWV9PC9oND5cbiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0b29sLWNhdGVnb3J5XCI+e3Rvb2wuY2F0ZWdvcnl9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidG9vbC1kZXNjcmlwdGlvblwiPnt0b29sLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0b29sLXN0YXRzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdGF0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJzdGF0LWxhYmVsXCI+VXNhZ2U6PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic3RhdC12YWx1ZVwiPnt0b29sLnVzYWdlQ291bnR9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3RhdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic3RhdC1sYWJlbFwiPlN1Y2Nlc3M6PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic3RhdC12YWx1ZVwiPnt0b29sLnN1Y2Nlc3NSYXRlLnRvRml4ZWQoMSl9JTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0YXRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInN0YXQtbGFiZWxcIj5BdmcgVGltZTo8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJzdGF0LXZhbHVlXCI+e3Rvb2wuYXZlcmFnZVJlc3BvbnNlVGltZX1tczwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIHt0b29sLmxhc3RVc2VkICYmIChcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRvb2wtbGFzdC11c2VkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICBMYXN0IHVzZWQ6IHt0b29sLmxhc3RVc2VkLnRvTG9jYWxlVGltZVN0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC8+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibm8tc2VydmVyLXNlbGVjdGVkXCI+XG4gICAgICAgICAgICAgIDxoMz5TZWxlY3QgYSBzZXJ2ZXIgdG8gdmlldyBpdHMgdG9vbHM8L2gzPlxuICAgICAgICAgICAgICA8cD5DaG9vc2UgYW4gTUNQIHNlcnZlciBmcm9tIHRoZSBzaWRlYmFyIHRvIGV4cGxvcmUgaXRzIGF2YWlsYWJsZSB0b29scyBhbmQgcGVyZm9ybWFuY2UgbWV0cmljcy48L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICB7LyogVG9vbCBFeGVjdXRpb24gUGFuZWwgKi99XG4gICAgICAgIHtzZWxlY3RlZFRvb2wgJiYgKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWNwLWV4ZWN1dGlvbi1wYW5lbFwiPlxuICAgICAgICAgICAgPGgzPkV4ZWN1dGUgVG9vbDoge3NlbGVjdGVkVG9vbC5uYW1lfTwvaDM+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImV4ZWN1dGlvbi1mb3JtXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFyYW1ldGVycy1zZWN0aW9uXCI+XG4gICAgICAgICAgICAgICAgPGg0PlBhcmFtZXRlcnM8L2g0PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFyYW1ldGVycy1ncmlkXCI+XG4gICAgICAgICAgICAgICAgICB7T2JqZWN0LmVudHJpZXMoc2VsZWN0ZWRUb29sLnBhcmFtZXRlcnMpLm1hcCgoW2tleSwgdHlwZV0pID0+IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2tleX0gY2xhc3NOYW1lPVwicGFyYW1ldGVyLWlucHV0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPntrZXl9PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9e3R5cGUgPT09ICdudW1iZXInID8gJ251bWJlcicgOiAndGV4dCd9XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17YEVudGVyICR7a2V5fSAoJHt0eXBlfSlgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicGFyYW1ldGVyLWZpZWxkXCJcbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJleGVjdXRlLWJ1dHRvblwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gZXhlY3V0ZVRvb2woc2VsZWN0ZWRUb29sLCB7fSl9XG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzRXhlY3V0aW5nfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge2lzRXhlY3V0aW5nID8gJ0V4ZWN1dGluZy4uLicgOiAnRXhlY3V0ZSBUb29sJ31cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAge2V4ZWN1dGlvblJlc3VsdHMubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXhlY3V0aW9uLXJlc3VsdHNcIj5cbiAgICAgICAgICAgICAgICA8aDQ+UmVjZW50IEV4ZWN1dGlvbnM8L2g0PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVzdWx0cy1saXN0XCI+XG4gICAgICAgICAgICAgICAgICB7ZXhlY3V0aW9uUmVzdWx0cy5zbGljZSgwLCA1KS5tYXAoKHJlc3VsdCwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2luZGV4fSBjbGFzc05hbWU9e2ByZXN1bHQtaXRlbSAke3Jlc3VsdC5zdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2Vycm9yJ31gfT5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlc3VsdC1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlc3VsdC10b29sXCI+e3Jlc3VsdC50b29sTmFtZX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJyZXN1bHQtdGltZVwiPntyZXN1bHQudGltZXN0YW1wLnRvTG9jYWxlVGltZVN0cmluZygpfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInJlc3VsdC1kdXJhdGlvblwiPntyZXN1bHQuZHVyYXRpb259bXM8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZXN1bHQtcmVzcG9uc2VcIj57cmVzdWx0LnJlc3BvbnNlfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBNY3BUb29sc0Rhc2hib2FyZCJdLCJ2ZXJzaW9uIjozfQ==