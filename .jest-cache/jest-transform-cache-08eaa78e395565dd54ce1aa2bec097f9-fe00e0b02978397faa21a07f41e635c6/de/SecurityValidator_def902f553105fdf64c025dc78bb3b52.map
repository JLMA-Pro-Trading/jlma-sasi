{"file":"/workspaces/agentists-quickstart-workspace-basic/sasi/src/security/SecurityValidator.ts","mappings":"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","names":[],"sources":["/workspaces/agentists-quickstart-workspace-basic/sasi/src/security/SecurityValidator.ts"],"sourcesContent":["/**\n * Security Validator - Input Validation and Security Hardening\n * Implements comprehensive security measures for neural agent system\n * \n * Security Features:\n * - Input validation and sanitization\n * - SQL injection prevention\n * - Neural weight integrity validation\n * - Rate limiting and DDoS protection\n * - Audit logging and monitoring\n */\n\nimport * as crypto from 'crypto';\nimport { performance } from 'perf_hooks';\n\nexport interface SecurityConfig {\n  enableInputValidation: boolean;\n  enableRateLimiting: boolean;\n  enableAuditLogging: boolean;\n  maxInputSize: number;\n  rateLimitWindow: number; // seconds\n  rateLimitMaxRequests: number;\n  encryptionKey?: string;\n}\n\nexport interface ValidationResult {\n  isValid: boolean;\n  errors: string[];\n  sanitizedInput?: any;\n  securityScore: number;\n}\n\nexport interface AuditLog {\n  timestamp: number;\n  action: string;\n  userId?: string;\n  agentId?: string;\n  ipAddress?: string;\n  details: any;\n  securityLevel: 'low' | 'medium' | 'high' | 'critical';\n}\n\nexport class SecurityValidator {\n  private config: SecurityConfig;\n  private requestCounts: Map<string, { count: number; windowStart: number }> = new Map();\n  private auditLogs: AuditLog[] = [];\n  private encryptionKey: Buffer;\n\n  constructor(config: Partial<SecurityConfig> = {}) {\n    this.config = {\n      enableInputValidation: true,\n      enableRateLimiting: true,\n      enableAuditLogging: true,\n      maxInputSize: 1024 * 1024, // 1MB\n      rateLimitWindow: 60, // 1 minute\n      rateLimitMaxRequests: 100,\n      ...config\n    };\n\n    // Initialize encryption key\n    this.encryptionKey = this.config.encryptionKey \n      ? Buffer.from(this.config.encryptionKey, 'hex')\n      : crypto.randomBytes(32);\n  }\n\n  /**\n   * Validate and sanitize SQL query parameters\n   * Prevents SQL injection attacks\n   */\n  validateSQLParameters(query: string, params: any[]): ValidationResult {\n    const errors: string[] = [];\n    let securityScore = 100;\n\n    // Check for SQL injection patterns\n    const sqlInjectionPatterns = [\n      /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION)\\b)/i,\n      /('|(--|\\/\\*|\\*\\/|;))/,\n      /((\\%27)|(\\')|(--)|(\\%23)|(#))/i,\n      /((\\%3D)|(=))[^\\n]*((\\%27)|(\\')|(--)|(\\%3B)|(;))/i,\n      /\\w*((\\%27)|(\\'))((\\%6F)|o|(\\%4F))((\\%72)|r|(\\%52))/i\n    ];\n\n    for (const param of params) {\n      if (typeof param === 'string') {\n        for (const pattern of sqlInjectionPatterns) {\n          if (pattern.test(param)) {\n            errors.push(`Potential SQL injection detected in parameter: ${param.substring(0, 50)}...`);\n            securityScore -= 20;\n          }\n        }\n\n        // Check for excessive length\n        if (param.length > this.config.maxInputSize) {\n          errors.push(`Parameter exceeds maximum length: ${param.length}`);\n          securityScore -= 10;\n        }\n      }\n    }\n\n    // Sanitize parameters\n    const sanitizedParams = params.map(param => {\n      if (typeof param === 'string') {\n        return param\n          .replace(/['\"]/g, '') // Remove quotes\n          .replace(/[-;]/g, '') // Remove dangerous characters\n          .substring(0, this.config.maxInputSize); // Truncate\n      }\n      return param;\n    });\n\n    this.auditLog('sql_validation', {\n      query: query.substring(0, 100),\n      paramCount: params.length,\n      securityScore,\n      errors: errors.length\n    }, errors.length > 0 ? 'high' : 'low');\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      sanitizedInput: sanitizedParams,\n      securityScore\n    };\n  }\n\n  /**\n   * Validate neural network input data\n   * Prevents malicious neural inputs\n   */\n  validateNeuralInput(inputs: Float32Array | number[]): ValidationResult {\n    const errors: string[] = [];\n    let securityScore = 100;\n\n    // Check input size\n    if (inputs.length > 10000) {\n      errors.push(`Neural input too large: ${inputs.length} elements`);\n      securityScore -= 30;\n    }\n\n    // Check for NaN or Infinity values\n    const invalidValues = Array.from(inputs).filter(val => !isFinite(val));\n    if (invalidValues.length > 0) {\n      errors.push(`Invalid values detected: ${invalidValues.length} NaN/Infinity values`);\n      securityScore -= 20;\n    }\n\n    // Check for extreme values that could cause overflow\n    const extremeValues = Array.from(inputs).filter(val => Math.abs(val) > 1000);\n    if (extremeValues.length > 0) {\n      errors.push(`Extreme values detected: ${extremeValues.length} values > 1000`);\n      securityScore -= 10;\n    }\n\n    // Sanitize inputs\n    const sanitizedInputs = Array.from(inputs).map(val => {\n      if (!isFinite(val)) return 0;\n      return Math.max(-1000, Math.min(1000, val)); // Clamp to safe range\n    });\n\n    this.auditLog('neural_input_validation', {\n      inputSize: inputs.length,\n      invalidValues: invalidValues.length,\n      extremeValues: extremeValues.length,\n      securityScore\n    }, extremeValues.length > 0 ? 'medium' : 'low');\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      sanitizedInput: new Float32Array(sanitizedInputs),\n      securityScore\n    };\n  }\n\n  /**\n   * Validate neural weight integrity with checksums\n   * Prevents weight tampering\n   */\n  validateNeuralWeights(weights: Buffer, expectedChecksum: string): ValidationResult {\n    const errors: string[] = [];\n    let securityScore = 100;\n\n    // Calculate actual checksum\n    const actualChecksum = crypto.createHash('sha256').update(weights).digest('hex');\n\n    // Verify integrity\n    if (actualChecksum !== expectedChecksum) {\n      errors.push('Neural weight integrity check failed - data may be corrupted or tampered');\n      securityScore = 0;\n    }\n\n    // Check weight size\n    if (weights.length > 100 * 1024 * 1024) { // 100MB limit\n      errors.push(`Neural weights too large: ${weights.length} bytes`);\n      securityScore -= 20;\n    }\n\n    // Check for patterns that might indicate malicious weights\n    const suspiciousPatterns = this.detectSuspiciousWeightPatterns(weights);\n    if (suspiciousPatterns.length > 0) {\n      errors.push(`Suspicious weight patterns detected: ${suspiciousPatterns.join(', ')}`);\n      securityScore -= 30;\n    }\n\n    this.auditLog('weight_validation', {\n      weightSize: weights.length,\n      checksumMatch: actualChecksum === expectedChecksum,\n      suspiciousPatterns: suspiciousPatterns.length,\n      securityScore\n    }, actualChecksum !== expectedChecksum ? 'critical' : 'low');\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      securityScore\n    };\n  }\n\n  /**\n   * Implement rate limiting for API endpoints\n   * Prevents DDoS and brute force attacks\n   */\n  checkRateLimit(identifier: string): ValidationResult {\n    if (!this.config.enableRateLimiting) {\n      return { isValid: true, errors: [], securityScore: 100 };\n    }\n\n    const now = Date.now();\n    const windowStart = now - (this.config.rateLimitWindow * 1000);\n    \n    const requestData = this.requestCounts.get(identifier);\n    \n    if (!requestData || requestData.windowStart < windowStart) {\n      // New window or identifier\n      this.requestCounts.set(identifier, { count: 1, windowStart: now });\n      return { isValid: true, errors: [], securityScore: 100 };\n    }\n\n    requestData.count++;\n\n    if (requestData.count > this.config.rateLimitMaxRequests) {\n      this.auditLog('rate_limit_exceeded', {\n        identifier,\n        requestCount: requestData.count,\n        timeWindow: this.config.rateLimitWindow\n      }, 'high');\n\n      return {\n        isValid: false,\n        errors: [`Rate limit exceeded: ${requestData.count} requests in ${this.config.rateLimitWindow}s`],\n        securityScore: 0\n      };\n    }\n\n    const securityScore = Math.max(0, 100 - (requestData.count / this.config.rateLimitMaxRequests) * 50);\n\n    return {\n      isValid: true,\n      errors: [],\n      securityScore\n    };\n  }\n\n  /**\n   * Encrypt sensitive data\n   */\n  encryptData(data: string): string {\n    const iv = crypto.randomBytes(16);\n    const cipher = crypto.createCipheriv('aes-256-gcm', this.encryptionKey, iv);\n    cipher.setAAD(Buffer.from('neural-agent-data'));\n    \n    let encrypted = cipher.update(data, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    \n    const authTag = cipher.getAuthTag();\n    \n    return iv.toString('hex') + ':' + authTag.toString('hex') + ':' + encrypted;\n  }\n\n  /**\n   * Decrypt sensitive data\n   */\n  decryptData(encryptedData: string): string {\n    const parts = encryptedData.split(':');\n    if (parts.length !== 3) {\n      throw new Error('Invalid encrypted data format');\n    }\n\n    const iv = Buffer.from(parts[0], 'hex');\n    const authTag = Buffer.from(parts[1], 'hex');\n    const encrypted = parts[2];\n\n    const decipher = crypto.createDecipheriv('aes-256-gcm', this.encryptionKey, iv);\n    decipher.setAAD(Buffer.from('neural-agent-data'));\n    decipher.setAuthTag(authTag);\n\n    let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n    decrypted += decipher.final('utf8');\n\n    return decrypted;\n  }\n\n  /**\n   * Generate secure random numbers for neural operations\n   */\n  generateSecureRandom(count: number): Float32Array {\n    const bytes = crypto.randomBytes(count * 4);\n    const randomValues = new Float32Array(count);\n    \n    for (let i = 0; i < count; i++) {\n      const uint32 = bytes.readUInt32BE(i * 4);\n      randomValues[i] = (uint32 / 0xFFFFFFFF) - 0.5; // Convert to [-0.5, 0.5]\n    }\n    \n    return randomValues;\n  }\n\n  /**\n   * Detect suspicious patterns in neural weights\n   */\n  private detectSuspiciousWeightPatterns(weights: Buffer): string[] {\n    const patterns: string[] = [];\n    const floats = new Float32Array(weights.buffer);\n\n    // Check for all zeros (potential memory wipe)\n    const zeroCount = floats.filter(w => w === 0).length;\n    if (zeroCount > floats.length * 0.9) {\n      patterns.push('excessive_zeros');\n    }\n\n    // Check for all same values (potential memory corruption)\n    const firstValue = floats[0];\n    const sameValueCount = floats.filter(w => w === firstValue).length;\n    if (sameValueCount > floats.length * 0.8) {\n      patterns.push('uniform_values');\n    }\n\n    // Check for extreme values (potential overflow attack)\n    const extremeCount = floats.filter(w => Math.abs(w) > 1000).length;\n    if (extremeCount > floats.length * 0.1) {\n      patterns.push('extreme_values');\n    }\n\n    // Check for NaN/Infinity (potential corruption)\n    const invalidCount = floats.filter(w => !isFinite(w)).length;\n    if (invalidCount > 0) {\n      patterns.push('invalid_values');\n    }\n\n    return patterns;\n  }\n\n  /**\n   * Add entry to audit log\n   */\n  private auditLog(action: string, details: any, securityLevel: 'low' | 'medium' | 'high' | 'critical' = 'low'): void {\n    if (!this.config.enableAuditLogging) return;\n\n    const logEntry: AuditLog = {\n      timestamp: Date.now(),\n      action,\n      details,\n      securityLevel\n    };\n\n    this.auditLogs.push(logEntry);\n\n    // Keep only last 10000 entries\n    if (this.auditLogs.length > 10000) {\n      this.auditLogs.splice(0, 1000);\n    }\n\n    // Log critical events immediately\n    if (securityLevel === 'critical') {\n      console.error('🚨 CRITICAL SECURITY EVENT:', logEntry);\n    } else if (securityLevel === 'high') {\n      console.warn('⚠️ HIGH SECURITY EVENT:', logEntry);\n    }\n  }\n\n  /**\n   * Get audit logs with optional filtering\n   */\n  getAuditLogs(filter?: {\n    action?: string;\n    securityLevel?: string;\n    startTime?: number;\n    endTime?: number;\n  }): AuditLog[] {\n    let logs = [...this.auditLogs];\n\n    if (filter) {\n      if (filter.action) {\n        logs = logs.filter(log => log.action === filter.action);\n      }\n      if (filter.securityLevel) {\n        logs = logs.filter(log => log.securityLevel === filter.securityLevel);\n      }\n      if (filter.startTime) {\n        logs = logs.filter(log => log.timestamp >= filter.startTime!);\n      }\n      if (filter.endTime) {\n        logs = logs.filter(log => log.timestamp <= filter.endTime!);\n      }\n    }\n\n    return logs.sort((a, b) => b.timestamp - a.timestamp);\n  }\n\n  /**\n   * Generate security compliance report\n   */\n  generateSecurityReport(): {\n    summary: {\n      totalAuditEvents: number;\n      criticalEvents: number;\n      highRiskEvents: number;\n      rateLimit: { enabled: boolean; currentRequests: number };\n      encryption: { enabled: boolean; keyLength: number };\n    };\n    recommendations: string[];\n    recentAlerts: AuditLog[];\n  } {\n    const criticalEvents = this.auditLogs.filter(log => log.securityLevel === 'critical').length;\n    const highRiskEvents = this.auditLogs.filter(log => log.securityLevel === 'high').length;\n    const recentAlerts = this.getAuditLogs({\n      startTime: Date.now() - (24 * 60 * 60 * 1000) // Last 24 hours\n    }).filter(log => log.securityLevel === 'high' || log.securityLevel === 'critical');\n\n    const currentRequests = Array.from(this.requestCounts.values())\n      .reduce((sum, data) => sum + data.count, 0);\n\n    const recommendations = [\n      'Implement parameterized SQL queries to prevent injection',\n      'Enable mandatory checksum validation for neural weights',\n      'Use cryptographically secure random number generation',\n      'Implement proper WASM memory bounds checking',\n      'Add input size limits for neural operations',\n      'Enable comprehensive audit logging',\n      'Implement session timeout and authentication',\n      'Add network-level security monitoring'\n    ];\n\n    return {\n      summary: {\n        totalAuditEvents: this.auditLogs.length,\n        criticalEvents,\n        highRiskEvents,\n        rateLimit: {\n          enabled: this.config.enableRateLimiting,\n          currentRequests\n        },\n        encryption: {\n          enabled: true,\n          keyLength: this.encryptionKey.length * 8\n        }\n      },\n      recommendations,\n      recentAlerts\n    };\n  }\n\n  /**\n   * Clean up old audit logs and rate limit data\n   */\n  cleanup(): void {\n    const now = Date.now();\n    const oldestAllowed = now - (7 * 24 * 60 * 60 * 1000); // 7 days\n\n    // Clean audit logs\n    this.auditLogs = this.auditLogs.filter(log => log.timestamp > oldestAllowed);\n\n    // Clean rate limit data\n    const windowStart = now - (this.config.rateLimitWindow * 1000);\n    for (const [key, data] of this.requestCounts.entries()) {\n      if (data.windowStart < windowStart) {\n        this.requestCounts.delete(key);\n      }\n    }\n  }\n}"],"version":3}