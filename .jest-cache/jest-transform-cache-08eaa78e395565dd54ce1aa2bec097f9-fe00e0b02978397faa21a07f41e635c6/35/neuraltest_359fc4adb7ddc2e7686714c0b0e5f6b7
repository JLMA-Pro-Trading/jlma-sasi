af39df99e4c5b289394301277228570d
"use strict";
/**
 * Unit Tests for Neural Type Definitions and Validation
 * Target: 95%+ coverage for type guards and validation functions
 */
Object.defineProperty(exports, "__esModule", { value: true });
const neural_1 = require("../../../src/types/neural");
describe('Neural Types - Comprehensive Tests', () => {
    describe('AgentState Enum', () => {
        test('should include all required states', () => {
            expect(neural_1.AgentState.INITIALIZING).toBe('initializing');
            expect(neural_1.AgentState.ACTIVE).toBe('active');
            expect(neural_1.AgentState.IDLE).toBe('idle');
            expect(neural_1.AgentState.LEARNING).toBe('learning');
            expect(neural_1.AgentState.TERMINATING).toBe('terminating');
            expect(neural_1.AgentState.ERROR).toBe('error');
        });
        test('should validate agent states correctly', () => {
            expect((0, neural_1.isValidAgentState)('active')).toBe(true);
            expect((0, neural_1.isValidAgentState)('learning')).toBe(true);
            expect((0, neural_1.isValidAgentState)('invalid')).toBe(false);
            expect((0, neural_1.isValidAgentState)('')).toBe(false);
            expect((0, neural_1.isValidAgentState)(null)).toBe(false);
            expect((0, neural_1.isValidAgentState)(undefined)).toBe(false);
        });
    });
    describe('NeuralConfiguration Validation', () => {
        test('should validate valid neural configurations', () => {
            const validConfig = {
                type: 'mlp',
                architecture: [10, 5, 1],
                activationFunction: 'tanh',
                learningRate: 0.001,
                batchSize: 32,
                epochs: 100
            };
            expect((0, neural_1.isValidNeuralConfiguration)(validConfig)).toBe(true);
        });
        test('should reject invalid neural configurations', () => {
            // Missing required fields
            expect((0, neural_1.isValidNeuralConfiguration)({})).toBe(false);
            expect((0, neural_1.isValidNeuralConfiguration)(null)).toBe(false);
            expect((0, neural_1.isValidNeuralConfiguration)(undefined)).toBe(false);
            // Invalid type
            expect((0, neural_1.isValidNeuralConfiguration)({
                type: '',
                architecture: [10, 1]
            })).toBe(false);
            // Invalid architecture
            expect((0, neural_1.isValidNeuralConfiguration)({
                type: 'mlp',
                architecture: []
            })).toBe(false);
            expect((0, neural_1.isValidNeuralConfiguration)({
                type: 'mlp',
                architecture: [-1, 5, 1]
            })).toBe(false);
            // Invalid learning rate
            expect((0, neural_1.isValidNeuralConfiguration)({
                type: 'mlp',
                architecture: [10, 1],
                learningRate: -0.1
            })).toBe(false);
            expect((0, neural_1.isValidNeuralConfiguration)({
                type: 'mlp',
                architecture: [10, 1],
                learningRate: 2.0
            })).toBe(false);
        });
        test('should validate network architectures', () => {
            expect((0, neural_1.validateNetworkArchitecture)([10, 5, 1])).toBe(true);
            expect((0, neural_1.validateNetworkArchitecture)([1])).toBe(true);
            expect((0, neural_1.validateNetworkArchitecture)([784, 128, 64, 10])).toBe(true);
            // Invalid architectures
            expect((0, neural_1.validateNetworkArchitecture)([])).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)([0, 5, 1])).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)([10, -1, 1])).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)([10, 5.5, 1])).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)(null)).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)(undefined)).toBe(false);
        });
        test('should normalize activation functions', () => {
            expect((0, neural_1.normalizeActivationFunction)('tanh')).toBe('tanh');
            expect((0, neural_1.normalizeActivationFunction)('relu')).toBe('relu');
            expect((0, neural_1.normalizeActivationFunction)('sigmoid')).toBe('sigmoid');
            expect((0, neural_1.normalizeActivationFunction)('linear')).toBe('linear');
            // Case normalization
            expect((0, neural_1.normalizeActivationFunction)('TANH')).toBe('tanh');
            expect((0, neural_1.normalizeActivationFunction)('ReLU')).toBe('relu');
            expect((0, neural_1.normalizeActivationFunction)('Sigmoid')).toBe('sigmoid');
            // Invalid functions should return default
            expect((0, neural_1.normalizeActivationFunction)('invalid')).toBe('tanh');
            expect((0, neural_1.normalizeActivationFunction)('')).toBe('tanh');
            expect((0, neural_1.normalizeActivationFunction)(null)).toBe('tanh');
            expect((0, neural_1.normalizeActivationFunction)(undefined)).toBe('tanh');
        });
    });
    describe('Edge Cases and Error Handling', () => {
        test('should handle edge case network architectures', () => {
            // Very large networks
            const largeArch = new Array(1000).fill(10);
            expect((0, neural_1.validateNetworkArchitecture)(largeArch)).toBe(true);
            // Single neuron networks
            expect((0, neural_1.validateNetworkArchitecture)([1])).toBe(true);
            // Very wide networks
            expect((0, neural_1.validateNetworkArchitecture)([10000, 1])).toBe(true);
        });
        test('should handle special numeric values', () => {
            expect((0, neural_1.validateNetworkArchitecture)([Infinity, 5, 1])).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)([NaN, 5, 1])).toBe(false);
            expect((0, neural_1.validateNetworkArchitecture)([10, Number.MAX_VALUE, 1])).toBe(true);
        });
        test('should validate complex neural configurations', () => {
            const complexConfig = {
                type: 'lstm',
                architecture: [784, 256, 128, 10],
                activationFunction: 'relu',
                learningRate: 0.001,
                batchSize: 64,
                epochs: 200,
                dropoutRate: 0.2,
                regularization: 'l2',
                optimizer: 'adam',
                lossFunction: 'crossentropy'
            };
            expect((0, neural_1.isValidNeuralConfiguration)(complexConfig)).toBe(true);
        });
        test('should handle mixed type inputs', () => {
            const mixedConfig = {
                type: 123, // Should be string
                architecture: "10,5,1", // Should be array
                learningRate: "0.001" // Should be number
            };
            expect((0, neural_1.isValidNeuralConfiguration)(mixedConfig)).toBe(false);
        });
    });
    describe('Performance Validation', () => {
        test('should validate large configurations efficiently', () => {
            const largeConfig = {
                type: 'cnn',
                architecture: new Array(1000).fill(128),
                activationFunction: 'relu',
                learningRate: 0.001
            };
            const startTime = performance.now();
            const isValid = (0, neural_1.isValidNeuralConfiguration)(largeConfig);
            const endTime = performance.now();
            expect(isValid).toBe(true);
            expect(endTime - startTime).toBeLessThan(100); // Should complete in < 100ms
        });
        test('should handle repeated validations efficiently', () => {
            const config = {
                type: 'mlp',
                architecture: [10, 5, 1],
                activationFunction: 'tanh'
            };
            const startTime = performance.now();
            for (let i = 0; i < 1000; i++) {
                (0, neural_1.isValidNeuralConfiguration)(config);
            }
            const endTime = performance.now();
            expect(endTime - startTime).toBeLessThan(100); // Should handle 1000 validations in < 100ms
        });
    });
    describe('Type Guards', () => {
        test('should correctly identify valid neural agents', () => {
            const validAgent = {
                id: 'agent-123',
                config: {
                    type: 'mlp',
                    architecture: [10, 5, 1]
                },
                state: neural_1.AgentState.ACTIVE,
                createdAt: Date.now(),
                lastActive: Date.now(),
                memoryUsage: 1024,
                totalInferences: 0,
                averageInferenceTime: 0,
                learningProgress: 0,
                connectionStrength: 1.0
            };
            // Test would require implementing isValidNeuralAgent function
            // For now, testing the components we have
            expect((0, neural_1.isValidAgentState)(validAgent.state)).toBe(true);
            expect((0, neural_1.isValidNeuralConfiguration)(validAgent.config)).toBe(true);
        });
        test('should handle circular references gracefully', () => {
            const circularConfig = {
                type: 'mlp',
                architecture: [10, 5, 1]
            };
            circularConfig.self = circularConfig;
            // Should not cause infinite recursion
            expect(() => (0, neural_1.isValidNeuralConfiguration)(circularConfig)).not.toThrow();
        });
        test('should validate nested configuration objects', () => {
            const nestedConfig = {
                type: 'transformer',
                architecture: [512, 256, 128],
                activationFunction: 'gelu',
                attention: {
                    heads: 8,
                    dimensions: 64,
                    dropout: 0.1
                },
                layers: {
                    encoder: 6,
                    decoder: 6,
                    feedForward: 2048
                }
            };
            expect((0, neural_1.isValidNeuralConfiguration)(nestedConfig)).toBe(true);
        });
    });
    describe('Custom Type Extensions', () => {
        test('should handle custom network types', () => {
            const customConfig = {
                type: 'custom_gan',
                architecture: [100, 256, 512, 784],
                activationFunction: 'leaky_relu',
                discriminator: {
                    architecture: [784, 512, 256, 1],
                    activationFunction: 'sigmoid'
                }
            };
            expect((0, neural_1.isValidNeuralConfiguration)(customConfig)).toBe(true);
        });
        test('should validate experimental activation functions', () => {
            expect((0, neural_1.normalizeActivationFunction)('swish')).toBe('tanh'); // Falls back to default
            expect((0, neural_1.normalizeActivationFunction)('mish')).toBe('tanh'); // Falls back to default
            expect((0, neural_1.normalizeActivationFunction)('gelu')).toBe('tanh'); // Falls back to default
        });
        test('should handle dynamic architecture definitions', () => {
            const dynamicArch = [
                Math.floor(Math.random() * 100) + 1,
                Math.floor(Math.random() * 50) + 1,
                Math.floor(Math.random() * 10) + 1
            ];
            expect((0, neural_1.validateNetworkArchitecture)(dynamicArch)).toBe(true);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL3dvcmtzcGFjZXMvYWdlbnRpc3RzLXF1aWNrc3RhcnQtd29ya3NwYWNlLWJhc2ljL3Nhc2kvdGVzdHMvdW5pdC90eXBlcy9uZXVyYWwudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOztBQUVILHNEQU9tQztBQUVuQyxRQUFRLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO0lBQ2xELFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDL0IsSUFBSSxDQUFDLG9DQUFvQyxFQUFFLEdBQUcsRUFBRTtZQUM5QyxNQUFNLENBQUMsbUJBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDckQsTUFBTSxDQUFDLG1CQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pDLE1BQU0sQ0FBQyxtQkFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNyQyxNQUFNLENBQUMsbUJBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDN0MsTUFBTSxDQUFDLG1CQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ25ELE1BQU0sQ0FBQyxtQkFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7WUFDbEQsTUFBTSxDQUFDLElBQUEsMEJBQWlCLEVBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLElBQUEsMEJBQWlCLEVBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLElBQUEsMEJBQWlCLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLElBQUEsMEJBQWlCLEVBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDMUMsTUFBTSxDQUFDLElBQUEsMEJBQWlCLEVBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLElBQUEsMEJBQWlCLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7UUFDOUMsSUFBSSxDQUFDLDZDQUE2QyxFQUFFLEdBQUcsRUFBRTtZQUN2RCxNQUFNLFdBQVcsR0FBd0I7Z0JBQ3ZDLElBQUksRUFBRSxLQUFLO2dCQUNYLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUN4QixrQkFBa0IsRUFBRSxNQUFNO2dCQUMxQixZQUFZLEVBQUUsS0FBSztnQkFDbkIsU0FBUyxFQUFFLEVBQUU7Z0JBQ2IsTUFBTSxFQUFFLEdBQUc7YUFDWixDQUFDO1lBRUYsTUFBTSxDQUFDLElBQUEsbUNBQTBCLEVBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsNkNBQTZDLEVBQUUsR0FBRyxFQUFFO1lBQ3ZELDBCQUEwQjtZQUMxQixNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNyRCxNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUxRCxlQUFlO1lBQ2YsTUFBTSxDQUFDLElBQUEsbUNBQTBCLEVBQUM7Z0JBQ2hDLElBQUksRUFBRSxFQUFFO2dCQUNSLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7YUFDdEIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRWhCLHVCQUF1QjtZQUN2QixNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQztnQkFDaEMsSUFBSSxFQUFFLEtBQUs7Z0JBQ1gsWUFBWSxFQUFFLEVBQUU7YUFDakIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRWhCLE1BQU0sQ0FBQyxJQUFBLG1DQUEwQixFQUFDO2dCQUNoQyxJQUFJLEVBQUUsS0FBSztnQkFDWCxZQUFZLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQ3pCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVoQix3QkFBd0I7WUFDeEIsTUFBTSxDQUFDLElBQUEsbUNBQTBCLEVBQUM7Z0JBQ2hDLElBQUksRUFBRSxLQUFLO2dCQUNYLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBQ3JCLFlBQVksRUFBRSxDQUFDLEdBQUc7YUFDbkIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRWhCLE1BQU0sQ0FBQyxJQUFBLG1DQUEwQixFQUFDO2dCQUNoQyxJQUFJLEVBQUUsS0FBSztnQkFDWCxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO2dCQUNyQixZQUFZLEVBQUUsR0FBRzthQUNsQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEIsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsdUNBQXVDLEVBQUUsR0FBRyxFQUFFO1lBQ2pELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzNELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsSUFBQSxvQ0FBMkIsRUFBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFbkUsd0JBQXdCO1lBQ3hCLE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzNELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDOUQsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsdUNBQXVDLEVBQUUsR0FBRyxFQUFFO1lBQ2pELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3pELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3pELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQy9ELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRTdELHFCQUFxQjtZQUNyQixNQUFNLENBQUMsSUFBQSxvQ0FBMkIsRUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN6RCxNQUFNLENBQUMsSUFBQSxvQ0FBMkIsRUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUN6RCxNQUFNLENBQUMsSUFBQSxvQ0FBMkIsRUFBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUUvRCwwQ0FBMEM7WUFDMUMsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDNUQsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDckQsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDdkQsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7UUFDN0MsSUFBSSxDQUFDLCtDQUErQyxFQUFFLEdBQUcsRUFBRTtZQUN6RCxzQkFBc0I7WUFDdEIsTUFBTSxTQUFTLEdBQUcsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRTFELHlCQUF5QjtZQUN6QixNQUFNLENBQUMsSUFBQSxvQ0FBMkIsRUFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFcEQscUJBQXFCO1lBQ3JCLE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO1lBQ2hELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2xFLE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzdELE1BQU0sQ0FBQyxJQUFBLG9DQUEyQixFQUFDLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM1RSxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQywrQ0FBK0MsRUFBRSxHQUFHLEVBQUU7WUFDekQsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLElBQUksRUFBRSxNQUFNO2dCQUNaLFlBQVksRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztnQkFDakMsa0JBQWtCLEVBQUUsTUFBTTtnQkFDMUIsWUFBWSxFQUFFLEtBQUs7Z0JBQ25CLFNBQVMsRUFBRSxFQUFFO2dCQUNiLE1BQU0sRUFBRSxHQUFHO2dCQUNYLFdBQVcsRUFBRSxHQUFHO2dCQUNoQixjQUFjLEVBQUUsSUFBSTtnQkFDcEIsU0FBUyxFQUFFLE1BQU07Z0JBQ2pCLFlBQVksRUFBRSxjQUFjO2FBQzdCLENBQUM7WUFFRixNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvRCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDM0MsTUFBTSxXQUFXLEdBQUc7Z0JBQ2xCLElBQUksRUFBRSxHQUFHLEVBQUUsbUJBQW1CO2dCQUM5QixZQUFZLEVBQUUsUUFBUSxFQUFFLGtCQUFrQjtnQkFDMUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxtQkFBbUI7YUFDMUMsQ0FBQztZQUVGLE1BQU0sQ0FBQyxJQUFBLG1DQUEwQixFQUFDLFdBQWtCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNyRSxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtRQUN0QyxJQUFJLENBQUMsa0RBQWtELEVBQUUsR0FBRyxFQUFFO1lBQzVELE1BQU0sV0FBVyxHQUFHO2dCQUNsQixJQUFJLEVBQUUsS0FBSztnQkFDWCxZQUFZLEVBQUUsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztnQkFDdkMsa0JBQWtCLEVBQUUsTUFBTTtnQkFDMUIsWUFBWSxFQUFFLEtBQUs7YUFDcEIsQ0FBQztZQUVGLE1BQU0sU0FBUyxHQUFHLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUNwQyxNQUFNLE9BQU8sR0FBRyxJQUFBLG1DQUEwQixFQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sT0FBTyxHQUFHLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUVsQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzNCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsNkJBQTZCO1FBQzlFLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLGdEQUFnRCxFQUFFLEdBQUcsRUFBRTtZQUMxRCxNQUFNLE1BQU0sR0FBRztnQkFDYixJQUFJLEVBQUUsS0FBSztnQkFDWCxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFDeEIsa0JBQWtCLEVBQUUsTUFBTTthQUMzQixDQUFDO1lBRUYsTUFBTSxTQUFTLEdBQUcsV0FBVyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ3BDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDOUIsSUFBQSxtQ0FBMEIsRUFBQyxNQUFNLENBQUMsQ0FBQztZQUNyQyxDQUFDO1lBQ0QsTUFBTSxPQUFPLEdBQUcsV0FBVyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBRWxDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsNENBQTRDO1FBQzdGLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUMzQixJQUFJLENBQUMsK0NBQStDLEVBQUUsR0FBRyxFQUFFO1lBQ3pELE1BQU0sVUFBVSxHQUFHO2dCQUNqQixFQUFFLEVBQUUsV0FBVztnQkFDZixNQUFNLEVBQUU7b0JBQ04sSUFBSSxFQUFFLEtBQUs7b0JBQ1gsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7aUJBQ3pCO2dCQUNELEtBQUssRUFBRSxtQkFBVSxDQUFDLE1BQU07Z0JBQ3hCLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO2dCQUNyQixVQUFVLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtnQkFDdEIsV0FBVyxFQUFFLElBQUk7Z0JBQ2pCLGVBQWUsRUFBRSxDQUFDO2dCQUNsQixvQkFBb0IsRUFBRSxDQUFDO2dCQUN2QixnQkFBZ0IsRUFBRSxDQUFDO2dCQUNuQixrQkFBa0IsRUFBRSxHQUFHO2FBQ3hCLENBQUM7WUFFRiw4REFBOEQ7WUFDOUQsMENBQTBDO1lBQzFDLE1BQU0sQ0FBQyxJQUFBLDBCQUFpQixFQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN2RCxNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkUsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsOENBQThDLEVBQUUsR0FBRyxFQUFFO1lBQ3hELE1BQU0sY0FBYyxHQUFRO2dCQUMxQixJQUFJLEVBQUUsS0FBSztnQkFDWCxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUN6QixDQUFDO1lBQ0YsY0FBYyxDQUFDLElBQUksR0FBRyxjQUFjLENBQUM7WUFFckMsc0NBQXNDO1lBQ3RDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFBLG1DQUEwQixFQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ3pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtZQUN4RCxNQUFNLFlBQVksR0FBRztnQkFDbkIsSUFBSSxFQUFFLGFBQWE7Z0JBQ25CLFlBQVksRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO2dCQUM3QixrQkFBa0IsRUFBRSxNQUFNO2dCQUMxQixTQUFTLEVBQUU7b0JBQ1QsS0FBSyxFQUFFLENBQUM7b0JBQ1IsVUFBVSxFQUFFLEVBQUU7b0JBQ2QsT0FBTyxFQUFFLEdBQUc7aUJBQ2I7Z0JBQ0QsTUFBTSxFQUFFO29CQUNOLE9BQU8sRUFBRSxDQUFDO29CQUNWLE9BQU8sRUFBRSxDQUFDO29CQUNWLFdBQVcsRUFBRSxJQUFJO2lCQUNsQjthQUNGLENBQUM7WUFFRixNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM5RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtRQUN0QyxJQUFJLENBQUMsb0NBQW9DLEVBQUUsR0FBRyxFQUFFO1lBQzlDLE1BQU0sWUFBWSxHQUFHO2dCQUNuQixJQUFJLEVBQUUsWUFBWTtnQkFDbEIsWUFBWSxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO2dCQUNsQyxrQkFBa0IsRUFBRSxZQUFZO2dCQUNoQyxhQUFhLEVBQUU7b0JBQ2IsWUFBWSxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO29CQUNoQyxrQkFBa0IsRUFBRSxTQUFTO2lCQUM5QjthQUNGLENBQUM7WUFFRixNQUFNLENBQUMsSUFBQSxtQ0FBMEIsRUFBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM5RCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxtREFBbUQsRUFBRSxHQUFHLEVBQUU7WUFDN0QsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyx3QkFBd0I7WUFDbkYsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyx3QkFBd0I7WUFDbEYsTUFBTSxDQUFDLElBQUEsb0NBQTJCLEVBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyx3QkFBd0I7UUFDcEYsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsZ0RBQWdELEVBQUUsR0FBRyxFQUFFO1lBQzFELE1BQU0sV0FBVyxHQUFHO2dCQUNsQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDO2dCQUNuQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO2dCQUNsQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO2FBQ25DLENBQUM7WUFFRixNQUFNLENBQUMsSUFBQSxvQ0FBMkIsRUFBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM5RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL3dvcmtzcGFjZXMvYWdlbnRpc3RzLXF1aWNrc3RhcnQtd29ya3NwYWNlLWJhc2ljL3Nhc2kvdGVzdHMvdW5pdC90eXBlcy9uZXVyYWwudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgVGVzdHMgZm9yIE5ldXJhbCBUeXBlIERlZmluaXRpb25zIGFuZCBWYWxpZGF0aW9uXG4gKiBUYXJnZXQ6IDk1JSsgY292ZXJhZ2UgZm9yIHR5cGUgZ3VhcmRzIGFuZCB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xuICovXG5cbmltcG9ydCB7IFxuICBBZ2VudFN0YXRlLCBcbiAgTmV1cmFsQ29uZmlndXJhdGlvbiwgXG4gIGlzVmFsaWRBZ2VudFN0YXRlLFxuICBpc1ZhbGlkTmV1cmFsQ29uZmlndXJhdGlvbixcbiAgdmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlLFxuICBub3JtYWxpemVBY3RpdmF0aW9uRnVuY3Rpb25cbn0gZnJvbSAnLi4vLi4vLi4vc3JjL3R5cGVzL25ldXJhbCc7XG5cbmRlc2NyaWJlKCdOZXVyYWwgVHlwZXMgLSBDb21wcmVoZW5zaXZlIFRlc3RzJywgKCkgPT4ge1xuICBkZXNjcmliZSgnQWdlbnRTdGF0ZSBFbnVtJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBpbmNsdWRlIGFsbCByZXF1aXJlZCBzdGF0ZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoQWdlbnRTdGF0ZS5JTklUSUFMSVpJTkcpLnRvQmUoJ2luaXRpYWxpemluZycpO1xuICAgICAgZXhwZWN0KEFnZW50U3RhdGUuQUNUSVZFKS50b0JlKCdhY3RpdmUnKTtcbiAgICAgIGV4cGVjdChBZ2VudFN0YXRlLklETEUpLnRvQmUoJ2lkbGUnKTtcbiAgICAgIGV4cGVjdChBZ2VudFN0YXRlLkxFQVJOSU5HKS50b0JlKCdsZWFybmluZycpO1xuICAgICAgZXhwZWN0KEFnZW50U3RhdGUuVEVSTUlOQVRJTkcpLnRvQmUoJ3Rlcm1pbmF0aW5nJyk7XG4gICAgICBleHBlY3QoQWdlbnRTdGF0ZS5FUlJPUikudG9CZSgnZXJyb3InKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSBhZ2VudCBzdGF0ZXMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGlzVmFsaWRBZ2VudFN0YXRlKCdhY3RpdmUnKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChpc1ZhbGlkQWdlbnRTdGF0ZSgnbGVhcm5pbmcnKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChpc1ZhbGlkQWdlbnRTdGF0ZSgnaW52YWxpZCcpKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChpc1ZhbGlkQWdlbnRTdGF0ZSgnJykpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGlzVmFsaWRBZ2VudFN0YXRlKG51bGwpKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChpc1ZhbGlkQWdlbnRTdGF0ZSh1bmRlZmluZWQpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05ldXJhbENvbmZpZ3VyYXRpb24gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgdmFsaWRhdGUgdmFsaWQgbmV1cmFsIGNvbmZpZ3VyYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRDb25maWc6IE5ldXJhbENvbmZpZ3VyYXRpb24gPSB7XG4gICAgICAgIHR5cGU6ICdtbHAnLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFsxMCwgNSwgMV0sXG4gICAgICAgIGFjdGl2YXRpb25GdW5jdGlvbjogJ3RhbmgnLFxuICAgICAgICBsZWFybmluZ1JhdGU6IDAuMDAxLFxuICAgICAgICBiYXRjaFNpemU6IDMyLFxuICAgICAgICBlcG9jaHM6IDEwMFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KGlzVmFsaWROZXVyYWxDb25maWd1cmF0aW9uKHZhbGlkQ29uZmlnKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgaW52YWxpZCBuZXVyYWwgY29uZmlndXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgICAvLyBNaXNzaW5nIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgZXhwZWN0KGlzVmFsaWROZXVyYWxDb25maWd1cmF0aW9uKHt9KSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24obnVsbCkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGlzVmFsaWROZXVyYWxDb25maWd1cmF0aW9uKHVuZGVmaW5lZCkpLnRvQmUoZmFsc2UpO1xuXG4gICAgICAvLyBJbnZhbGlkIHR5cGVcbiAgICAgIGV4cGVjdChpc1ZhbGlkTmV1cmFsQ29uZmlndXJhdGlvbih7XG4gICAgICAgIHR5cGU6ICcnLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFsxMCwgMV1cbiAgICAgIH0pKS50b0JlKGZhbHNlKTtcblxuICAgICAgLy8gSW52YWxpZCBhcmNoaXRlY3R1cmVcbiAgICAgIGV4cGVjdChpc1ZhbGlkTmV1cmFsQ29uZmlndXJhdGlvbih7XG4gICAgICAgIHR5cGU6ICdtbHAnLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFtdXG4gICAgICB9KSkudG9CZShmYWxzZSk7XG5cbiAgICAgIGV4cGVjdChpc1ZhbGlkTmV1cmFsQ29uZmlndXJhdGlvbih7XG4gICAgICAgIHR5cGU6ICdtbHAnLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFstMSwgNSwgMV1cbiAgICAgIH0pKS50b0JlKGZhbHNlKTtcblxuICAgICAgLy8gSW52YWxpZCBsZWFybmluZyByYXRlXG4gICAgICBleHBlY3QoaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24oe1xuICAgICAgICB0eXBlOiAnbWxwJyxcbiAgICAgICAgYXJjaGl0ZWN0dXJlOiBbMTAsIDFdLFxuICAgICAgICBsZWFybmluZ1JhdGU6IC0wLjFcbiAgICAgIH0pKS50b0JlKGZhbHNlKTtcblxuICAgICAgZXhwZWN0KGlzVmFsaWROZXVyYWxDb25maWd1cmF0aW9uKHtcbiAgICAgICAgdHlwZTogJ21scCcsXG4gICAgICAgIGFyY2hpdGVjdHVyZTogWzEwLCAxXSxcbiAgICAgICAgbGVhcm5pbmdSYXRlOiAyLjBcbiAgICAgIH0pKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSBuZXR3b3JrIGFyY2hpdGVjdHVyZXMnLCAoKSA9PiB7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKFsxMCwgNSwgMV0pKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRlTmV0d29ya0FyY2hpdGVjdHVyZShbMV0pKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRlTmV0d29ya0FyY2hpdGVjdHVyZShbNzg0LCAxMjgsIDY0LCAxMF0pKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBJbnZhbGlkIGFyY2hpdGVjdHVyZXNcbiAgICAgIGV4cGVjdCh2YWxpZGF0ZU5ldHdvcmtBcmNoaXRlY3R1cmUoW10pKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdCh2YWxpZGF0ZU5ldHdvcmtBcmNoaXRlY3R1cmUoWzAsIDUsIDFdKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKFsxMCwgLTEsIDFdKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKFsxMCwgNS41LCAxXSkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRlTmV0d29ya0FyY2hpdGVjdHVyZShudWxsKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKHVuZGVmaW5lZCkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIG5vcm1hbGl6ZSBhY3RpdmF0aW9uIGZ1bmN0aW9ucycsICgpID0+IHtcbiAgICAgIGV4cGVjdChub3JtYWxpemVBY3RpdmF0aW9uRnVuY3Rpb24oJ3RhbmgnKSkudG9CZSgndGFuaCcpO1xuICAgICAgZXhwZWN0KG5vcm1hbGl6ZUFjdGl2YXRpb25GdW5jdGlvbigncmVsdScpKS50b0JlKCdyZWx1Jyk7XG4gICAgICBleHBlY3Qobm9ybWFsaXplQWN0aXZhdGlvbkZ1bmN0aW9uKCdzaWdtb2lkJykpLnRvQmUoJ3NpZ21vaWQnKTtcbiAgICAgIGV4cGVjdChub3JtYWxpemVBY3RpdmF0aW9uRnVuY3Rpb24oJ2xpbmVhcicpKS50b0JlKCdsaW5lYXInKTtcblxuICAgICAgLy8gQ2FzZSBub3JtYWxpemF0aW9uXG4gICAgICBleHBlY3Qobm9ybWFsaXplQWN0aXZhdGlvbkZ1bmN0aW9uKCdUQU5IJykpLnRvQmUoJ3RhbmgnKTtcbiAgICAgIGV4cGVjdChub3JtYWxpemVBY3RpdmF0aW9uRnVuY3Rpb24oJ1JlTFUnKSkudG9CZSgncmVsdScpO1xuICAgICAgZXhwZWN0KG5vcm1hbGl6ZUFjdGl2YXRpb25GdW5jdGlvbignU2lnbW9pZCcpKS50b0JlKCdzaWdtb2lkJyk7XG5cbiAgICAgIC8vIEludmFsaWQgZnVuY3Rpb25zIHNob3VsZCByZXR1cm4gZGVmYXVsdFxuICAgICAgZXhwZWN0KG5vcm1hbGl6ZUFjdGl2YXRpb25GdW5jdGlvbignaW52YWxpZCcpKS50b0JlKCd0YW5oJyk7XG4gICAgICBleHBlY3Qobm9ybWFsaXplQWN0aXZhdGlvbkZ1bmN0aW9uKCcnKSkudG9CZSgndGFuaCcpO1xuICAgICAgZXhwZWN0KG5vcm1hbGl6ZUFjdGl2YXRpb25GdW5jdGlvbihudWxsKSkudG9CZSgndGFuaCcpO1xuICAgICAgZXhwZWN0KG5vcm1hbGl6ZUFjdGl2YXRpb25GdW5jdGlvbih1bmRlZmluZWQpKS50b0JlKCd0YW5oJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFZGdlIENhc2VzIGFuZCBFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVkZ2UgY2FzZSBuZXR3b3JrIGFyY2hpdGVjdHVyZXMnLCAoKSA9PiB7XG4gICAgICAvLyBWZXJ5IGxhcmdlIG5ldHdvcmtzXG4gICAgICBjb25zdCBsYXJnZUFyY2ggPSBuZXcgQXJyYXkoMTAwMCkuZmlsbCgxMCk7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKGxhcmdlQXJjaCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFNpbmdsZSBuZXVyb24gbmV0d29ya3NcbiAgICAgIGV4cGVjdCh2YWxpZGF0ZU5ldHdvcmtBcmNoaXRlY3R1cmUoWzFdKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyeSB3aWRlIG5ldHdvcmtzXG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKFsxMDAwMCwgMV0pKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBzcGVjaWFsIG51bWVyaWMgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KHZhbGlkYXRlTmV0d29ya0FyY2hpdGVjdHVyZShbSW5maW5pdHksIDUsIDFdKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKFtOYU4sIDUsIDFdKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKFsxMCwgTnVtYmVyLk1BWF9WQUxVRSwgMV0pKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIGNvbXBsZXggbmV1cmFsIGNvbmZpZ3VyYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29tcGxleENvbmZpZyA9IHtcbiAgICAgICAgdHlwZTogJ2xzdG0nLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFs3ODQsIDI1NiwgMTI4LCAxMF0sXG4gICAgICAgIGFjdGl2YXRpb25GdW5jdGlvbjogJ3JlbHUnLFxuICAgICAgICBsZWFybmluZ1JhdGU6IDAuMDAxLFxuICAgICAgICBiYXRjaFNpemU6IDY0LFxuICAgICAgICBlcG9jaHM6IDIwMCxcbiAgICAgICAgZHJvcG91dFJhdGU6IDAuMixcbiAgICAgICAgcmVndWxhcml6YXRpb246ICdsMicsXG4gICAgICAgIG9wdGltaXplcjogJ2FkYW0nLFxuICAgICAgICBsb3NzRnVuY3Rpb246ICdjcm9zc2VudHJvcHknXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24oY29tcGxleENvbmZpZykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG1peGVkIHR5cGUgaW5wdXRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWl4ZWRDb25maWcgPSB7XG4gICAgICAgIHR5cGU6IDEyMywgLy8gU2hvdWxkIGJlIHN0cmluZ1xuICAgICAgICBhcmNoaXRlY3R1cmU6IFwiMTAsNSwxXCIsIC8vIFNob3VsZCBiZSBhcnJheVxuICAgICAgICBsZWFybmluZ1JhdGU6IFwiMC4wMDFcIiAvLyBTaG91bGQgYmUgbnVtYmVyXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24obWl4ZWRDb25maWcgYXMgYW55KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZSBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSBsYXJnZSBjb25maWd1cmF0aW9ucyBlZmZpY2llbnRseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGxhcmdlQ29uZmlnID0ge1xuICAgICAgICB0eXBlOiAnY25uJyxcbiAgICAgICAgYXJjaGl0ZWN0dXJlOiBuZXcgQXJyYXkoMTAwMCkuZmlsbCgxMjgpLFxuICAgICAgICBhY3RpdmF0aW9uRnVuY3Rpb246ICdyZWx1JyxcbiAgICAgICAgbGVhcm5pbmdSYXRlOiAwLjAwMVxuICAgICAgfTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCBpc1ZhbGlkID0gaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24obGFyZ2VDb25maWcpO1xuICAgICAgY29uc3QgZW5kVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICBleHBlY3QoaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChlbmRUaW1lIC0gc3RhcnRUaW1lKS50b0JlTGVzc1RoYW4oMTAwKTsgLy8gU2hvdWxkIGNvbXBsZXRlIGluIDwgMTAwbXNcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcmVwZWF0ZWQgdmFsaWRhdGlvbnMgZWZmaWNpZW50bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgIHR5cGU6ICdtbHAnLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFsxMCwgNSwgMV0sXG4gICAgICAgIGFjdGl2YXRpb25GdW5jdGlvbjogJ3RhbmgnXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwMDsgaSsrKSB7XG4gICAgICAgIGlzVmFsaWROZXVyYWxDb25maWd1cmF0aW9uKGNvbmZpZyk7XG4gICAgICB9XG4gICAgICBjb25zdCBlbmRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIGV4cGVjdChlbmRUaW1lIC0gc3RhcnRUaW1lKS50b0JlTGVzc1RoYW4oMTAwKTsgLy8gU2hvdWxkIGhhbmRsZSAxMDAwIHZhbGlkYXRpb25zIGluIDwgMTAwbXNcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1R5cGUgR3VhcmRzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBjb3JyZWN0bHkgaWRlbnRpZnkgdmFsaWQgbmV1cmFsIGFnZW50cycsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbGlkQWdlbnQgPSB7XG4gICAgICAgIGlkOiAnYWdlbnQtMTIzJyxcbiAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgdHlwZTogJ21scCcsXG4gICAgICAgICAgYXJjaGl0ZWN0dXJlOiBbMTAsIDUsIDFdXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXRlOiBBZ2VudFN0YXRlLkFDVElWRSxcbiAgICAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpLFxuICAgICAgICBsYXN0QWN0aXZlOiBEYXRlLm5vdygpLFxuICAgICAgICBtZW1vcnlVc2FnZTogMTAyNCxcbiAgICAgICAgdG90YWxJbmZlcmVuY2VzOiAwLFxuICAgICAgICBhdmVyYWdlSW5mZXJlbmNlVGltZTogMCxcbiAgICAgICAgbGVhcm5pbmdQcm9ncmVzczogMCxcbiAgICAgICAgY29ubmVjdGlvblN0cmVuZ3RoOiAxLjBcbiAgICAgIH07XG5cbiAgICAgIC8vIFRlc3Qgd291bGQgcmVxdWlyZSBpbXBsZW1lbnRpbmcgaXNWYWxpZE5ldXJhbEFnZW50IGZ1bmN0aW9uXG4gICAgICAvLyBGb3Igbm93LCB0ZXN0aW5nIHRoZSBjb21wb25lbnRzIHdlIGhhdmVcbiAgICAgIGV4cGVjdChpc1ZhbGlkQWdlbnRTdGF0ZSh2YWxpZEFnZW50LnN0YXRlKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChpc1ZhbGlkTmV1cmFsQ29uZmlndXJhdGlvbih2YWxpZEFnZW50LmNvbmZpZykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGNpcmN1bGFyIHJlZmVyZW5jZXMgZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNpcmN1bGFyQ29uZmlnOiBhbnkgPSB7XG4gICAgICAgIHR5cGU6ICdtbHAnLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFsxMCwgNSwgMV1cbiAgICAgIH07XG4gICAgICBjaXJjdWxhckNvbmZpZy5zZWxmID0gY2lyY3VsYXJDb25maWc7XG5cbiAgICAgIC8vIFNob3VsZCBub3QgY2F1c2UgaW5maW5pdGUgcmVjdXJzaW9uXG4gICAgICBleHBlY3QoKCkgPT4gaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24oY2lyY3VsYXJDb25maWcpKS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIG5lc3RlZCBjb25maWd1cmF0aW9uIG9iamVjdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBuZXN0ZWRDb25maWcgPSB7XG4gICAgICAgIHR5cGU6ICd0cmFuc2Zvcm1lcicsXG4gICAgICAgIGFyY2hpdGVjdHVyZTogWzUxMiwgMjU2LCAxMjhdLFxuICAgICAgICBhY3RpdmF0aW9uRnVuY3Rpb246ICdnZWx1JyxcbiAgICAgICAgYXR0ZW50aW9uOiB7XG4gICAgICAgICAgaGVhZHM6IDgsXG4gICAgICAgICAgZGltZW5zaW9uczogNjQsXG4gICAgICAgICAgZHJvcG91dDogMC4xXG4gICAgICAgIH0sXG4gICAgICAgIGxheWVyczoge1xuICAgICAgICAgIGVuY29kZXI6IDYsXG4gICAgICAgICAgZGVjb2RlcjogNixcbiAgICAgICAgICBmZWVkRm9yd2FyZDogMjA0OFxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoaXNWYWxpZE5ldXJhbENvbmZpZ3VyYXRpb24obmVzdGVkQ29uZmlnKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0N1c3RvbSBUeXBlIEV4dGVuc2lvbnMnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBjdXN0b20gbmV0d29yayB0eXBlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGN1c3RvbUNvbmZpZyA9IHtcbiAgICAgICAgdHlwZTogJ2N1c3RvbV9nYW4nLFxuICAgICAgICBhcmNoaXRlY3R1cmU6IFsxMDAsIDI1NiwgNTEyLCA3ODRdLFxuICAgICAgICBhY3RpdmF0aW9uRnVuY3Rpb246ICdsZWFreV9yZWx1JyxcbiAgICAgICAgZGlzY3JpbWluYXRvcjoge1xuICAgICAgICAgIGFyY2hpdGVjdHVyZTogWzc4NCwgNTEyLCAyNTYsIDFdLFxuICAgICAgICAgIGFjdGl2YXRpb25GdW5jdGlvbjogJ3NpZ21vaWQnXG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChpc1ZhbGlkTmV1cmFsQ29uZmlndXJhdGlvbihjdXN0b21Db25maWcpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHZhbGlkYXRlIGV4cGVyaW1lbnRhbCBhY3RpdmF0aW9uIGZ1bmN0aW9ucycsICgpID0+IHtcbiAgICAgIGV4cGVjdChub3JtYWxpemVBY3RpdmF0aW9uRnVuY3Rpb24oJ3N3aXNoJykpLnRvQmUoJ3RhbmgnKTsgLy8gRmFsbHMgYmFjayB0byBkZWZhdWx0XG4gICAgICBleHBlY3Qobm9ybWFsaXplQWN0aXZhdGlvbkZ1bmN0aW9uKCdtaXNoJykpLnRvQmUoJ3RhbmgnKTsgLy8gRmFsbHMgYmFjayB0byBkZWZhdWx0XG4gICAgICBleHBlY3Qobm9ybWFsaXplQWN0aXZhdGlvbkZ1bmN0aW9uKCdnZWx1JykpLnRvQmUoJ3RhbmgnKTsgLy8gRmFsbHMgYmFjayB0byBkZWZhdWx0XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGR5bmFtaWMgYXJjaGl0ZWN0dXJlIGRlZmluaXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgZHluYW1pY0FyY2ggPSBbXG4gICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCkgKyAxLFxuICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1MCkgKyAxLFxuICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCkgKyAxXG4gICAgICBdO1xuXG4gICAgICBleHBlY3QodmFsaWRhdGVOZXR3b3JrQXJjaGl0ZWN0dXJlKGR5bmFtaWNBcmNoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=